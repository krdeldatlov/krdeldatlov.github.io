(this.webpackJsonpkrdeldatlov=this.webpackJsonpkrdeldatlov||[]).push([[0],{14:function(e,t,a){var r=a(739),s=a(4),n=a(741);self,e.exports=(()=>{"use strict";var e={129:(e,t,a)=>{a.r(t),a.d(t,{ajax:()=>U,auth:()=>A,getConfig:()=>R,init:()=>L,mail:()=>W,storage:()=>i,store:()=>M});var i={};a.r(i),a.d(i,{getUser:()=>c,removeUser:()=>l,setUser:()=>o});const c=()=>JSON.parse(sessionStorage.getItem("kd-user")),o=e=>{var t;t=e,sessionStorage.setItem("kd-user",JSON.stringify(t))},l=()=>{sessionStorage.removeItem("kd-user")},u=[],d={limit:1e3,skip:0},p={field:"_id",dir:"asc"},h=[],f=()=>{var e=c();return{Accept:"application/json","Content-Type":"application/json",Authorization:e?"Bearer  ".concat(e.token):null}},b=function(){var e=n(s.mark((function e(t){var a,r,n,i;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(t.url.auth,"/api/User/refresh"),r=c(),n=r?r.refreshToken:t.key,e.next=5,fetch(a,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(n)}});case 5:if(200!==(i=e.sent).status){e.next=11;break}return e.next=9,i.json();case 9:return t=e.sent,e.abrupt("return",(t.refreshToken=n,o(t),!0));case 11:return e.abrupt("return",(l(),!1));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=n(s.mark((function e(t,a,r){var n,i;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(a,"/").concat(r),e.next=3,fetch(n,{headers:f()});case 3:if(200!==(i=e.sent).status){e.next=8;break}return e.next=7,i.json();case 7:return e.abrupt("return",e.sent);case 8:if(404!==i.status){e.next=10;break}return e.abrupt("return",null);case 10:if(e.t0=401===i.status,!e.t0){e.next=15;break}return e.next=14,b(t);case 14:e.t0=e.sent;case 15:if(!e.t0){e.next=19;break}return e.next=18,x(t,a,r);case 18:return e.abrupt("return",e.sent);case 19:throw new Error(i.statusText);case 20:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),m=function(){var e=n(s.mark((function e(t,a,r=u,n=p,i=d,c=h){var o,l;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="".concat(a,"?filters=").concat(JSON.stringify(r),"&page=").concat(JSON.stringify(i),"&sort=").concat(JSON.stringify(n),"&fields=").concat(JSON.stringify(c)),e.next=3,fetch(o,{headers:f()});case 3:if(200!==(l=e.sent).status){e.next=9;break}return e.next=7,l.json();case 7:return t=e.sent,e.abrupt("return",(t.filters=r,t.sort=n,t.page=i,t.fields=c,t));case 9:if(e.t0=401===l.status,!e.t0){e.next=14;break}return e.next=13,b(t);case 13:e.t0=e.sent;case 14:if(!e.t0){e.next=18;break}return e.next=17,m(t,a,r,n,i,c);case 17:return e.abrupt("return",e.sent);case 18:throw new Error(l.statusText);case 19:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),j=function(){var e=n(s.mark((function e(t,a,r,n){var i,c;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="".concat(a,"/").concat(n),e.next=3,fetch(i,{method:"PUT",headers:f(),body:JSON.stringify(r)});case 3:if(200!==(c=e.sent).status){e.next=8;break}return e.next=7,c.json();case 7:return e.abrupt("return",e.sent);case 8:if(e.t0=401===c.status,!e.t0){e.next=13;break}return e.next=12,b(t);case 12:e.t0=e.sent;case 13:if(!e.t0){e.next=17;break}return e.next=16,j(t,a,r,n);case 16:return e.abrupt("return",e.sent);case 17:throw new Error(c.statusText);case 18:case"end":return e.stop()}}),e)})));return function(t,a,r,s){return e.apply(this,arguments)}}(),v=function(){var e=n(s.mark((function e(t,a,r){var n,i;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(a),e.next=3,fetch(n,{method:"POST",headers:f(),body:JSON.stringify(r)});case 3:if(200!==(i=e.sent).status){e.next=8;break}return e.next=7,i.json();case 7:return e.abrupt("return",e.sent);case 8:if(e.t0=401===i.status,!e.t0){e.next=13;break}return e.next=12,b(t);case 12:e.t0=e.sent;case 13:if(!e.t0){e.next=17;break}return e.next=16,v(t,a,r);case 16:return e.abrupt("return",e.sent);case 17:throw new Error(i.statusText);case 18:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),g=function(){var e=n(s.mark((function e(t,a,r){var n,i;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(a,"/").concat(r),e.next=3,fetch(n,{method:"DELETE",headers:f()});case 3:if(200!==(i=e.sent).status){e.next=8;break}e.next=17;break;case 8:if(e.t0=401!==i.status,e.t0){e.next=13;break}return e.next=12,b(t);case 12:e.t0=!e.sent;case 13:if(!e.t0){e.next=15;break}throw new Error(i.statusText);case 15:return e.next=17,g(t,a,r);case 17:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),O=function(){var e=n(s.mark((function e(t,a,r){var n,i;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(a,"?filters=").concat(JSON.stringify(r)),e.next=3,fetch(n,{method:"DELETE",headers:f()});case 3:if(200===(i=e.sent).status){e.next=15;break}if(e.t0=401===i.status,!e.t0){e.next=10;break}return e.next=9,b(t);case 9:e.t0=e.sent;case 10:if(!e.t0){e.next=14;break}return e.next=13,O(t,a,r);case 13:return e.abrupt("return",e.sent);case 14:throw new Error(i.statusText);case 15:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),w=function(){var e=n(s.mark((function e(t,a){var r,n,i;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(t.url.store,"/api/file"),(n=new FormData).append("file",a),e.next=4,fetch(r,{method:"POST",headers:{Authorization:"Bearer "+c().token},body:n});case 4:if(200!==(i=e.sent).status){e.next=9;break}return e.next=8,i.json();case 8:return e.abrupt("return",e.sent);case 9:if(e.t0=401===i.status,!e.t0){e.next=14;break}return e.next=13,b(t);case 13:e.t0=e.sent;case 14:if(!e.t0){e.next=18;break}return e.next=17,w(t,a);case 17:return e.abrupt("return",e.sent);case 18:throw new Error(i.statusText);case 19:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),k=function(){var e=n(s.mark((function e(t,a){var r,n,i,o,l;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="file/"+a,e.next=3,caches.open("kd-cache");case 3:return n=e.sent,e.next=6,n.match(r);case 6:if(!(i=e.sent)){e.next=11;break}return e.next=10,i.blob();case 10:return e.abrupt("return",e.sent);case 11:return o="".concat(t.url.store,"/api/file/").concat(a),e.next=14,fetch(o,{method:"GET",headers:{Authorization:"Bearer "+c().token}});case 14:if(200!==(l=e.sent).status){e.next=20;break}return n.put(r,l.clone()),e.next=19,l.blob();case 19:return e.abrupt("return",e.sent);case 20:if(e.t0=401===l.status,!e.t0){e.next=25;break}return e.next=24,b(t);case 24:e.t0=e.sent;case 25:if(!e.t0){e.next=29;break}return e.next=28,k(t,a);case 28:return e.abrupt("return",e.sent);case 29:throw new Error(l.statusText);case 30:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),y=function(){var e=n(s.mark((function e(t,a){var r,n;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(t.url.store,"/api/file/").concat(a),e.next=3,fetch(r,{method:"DELETE",headers:{Authorization:"Bearer "+c().token}});case 3:if(200!==(n=e.sent).status){e.next=8;break}e.next=17;break;case 8:if(e.t0=401!==n.status,e.t0){e.next=13;break}return e.next=12,b(t);case 12:e.t0=!e.sent;case 13:if(!e.t0){e.next=15;break}throw new Error(n.statusText);case 15:return e.next=17,y(t,a);case 17:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),C=function(){var e=n(s.mark((function e(t,a,r,n=u,i=p,c=d){var o,l;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="".concat(t.url.store,"/api/store/").concat(a,"/aggregation?group=").concat(JSON.stringify(r),"&filters=").concat(JSON.stringify(n),"&sort=").concat(JSON.stringify(i),"&page=").concat(JSON.stringify(c)),e.next=3,fetch(o,{headers:f()});case 3:if(200!==(l=e.sent).status){e.next=8;break}return e.next=7,l.json();case 7:return e.abrupt("return",e.sent);case 8:if(e.t0=401===l.status,!e.t0){e.next=13;break}return e.next=12,b(t);case 12:e.t0=e.sent;case 13:if(!e.t0){e.next=17;break}return e.next=16,C(t,a,r,n,i);case 16:return e.abrupt("return",e.sent);case 17:throw new Error(l.statusText);case 18:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),S=function(){var e=n(s.mark((function e(t,a,r,n){var i,c;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="".concat(t.url.auth,"/api/user/oauth"),e.next=3,fetch(i,{method:"PUT",headers:f(),body:JSON.stringify({provider:a,code:r,redirect_uri:n})});case 3:if(200!==(c=e.sent).status){e.next=8;break}return e.next=7,c.json();case 7:return e.abrupt("return",e.sent);case 8:if(e.t0=401===c.status,!e.t0){e.next=13;break}return e.next=12,b(t);case 12:e.t0=e.sent;case 13:if(!e.t0){e.next=17;break}return e.next=16,S(t,a,r,n);case 16:return e.abrupt("return",e.sent);case 17:throw new Error(c.statusText);case 18:case"end":return e.stop()}}),e)})));return function(t,a,r,s){return e.apply(this,arguments)}}(),T=function(){var e=n(s.mark((function e(t){var a,r;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(t.url.auth,"/api/user/secret"),e.next=3,fetch(a,{method:"POST",headers:f()});case 3:if(200!==(r=e.sent).status){e.next=8;break}return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 8:if(e.t0=401===r.status,!e.t0){e.next=13;break}return e.next=12,b(t);case 12:e.t0=e.sent;case 13:if(!e.t0){e.next=17;break}return e.next=16,T(t);case 16:return e.abrupt("return",e.sent);case 17:throw new Error(r.statusText);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=n(s.mark((function e(t,a){var r,n;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(t.url.auth,"/api/user/sign?withQrCode=true"),e.next=3,fetch(r,{method:"POST",headers:f(),body:JSON.stringify({data:a})});case 3:if(200!==(n=e.sent).status){e.next=8;break}return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:if(e.t0=401===n.status,!e.t0){e.next=13;break}return e.next=12,b(t);case 12:e.t0=e.sent;case 13:if(!e.t0){e.next=17;break}return e.next=16,D(t,a);case 16:return e.abrupt("return",e.sent);case 17:throw new Error(n.statusText);case 18:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),I=function(){var e=n(s.mark((function e(t,a,r){var n,i;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(t.url.auth,"/api/user/verify"),e.next=3,fetch(n,{method:"POST",headers:f(),body:JSON.stringify({data:a,signature:r})});case 3:if(200!==(i=e.sent).status){e.next=6;break}return e.abrupt("return",!0);case 6:if(400!==i.status){e.next=8;break}return e.abrupt("return",!1);case 8:if(e.t0=401===i.status,!e.t0){e.next=13;break}return e.next=12,b(t);case 12:e.t0=e.sent;case 13:if(!e.t0){e.next=17;break}return e.next=16,I(t,a,r);case 16:return e.abrupt("return",e.sent);case 17:throw new Error(i.statusText);case 18:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),_=function(){var e=n(s.mark((function e(t,a,r={field:"name",dir:"asc"},n=d){var i,c;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="".concat(t.url.auth,"/api/user?filters=").concat(JSON.stringify(a),"&page=").concat(JSON.stringify(n),"&sort=").concat(JSON.stringify(r)),e.next=3,fetch(i,{headers:f()});case 3:if(200!==(c=e.sent).status){e.next=8;break}return e.next=7,c.json();case 7:return e.abrupt("return",e.sent);case 8:if(e.t0=401===c.status,!e.t0){e.next=13;break}return e.next=12,b(t);case 12:e.t0=e.sent;case 13:if(!e.t0){e.next=17;break}return e.next=16,_(t,a,r,n);case 16:return e.abrupt("return",e.sent);case 17:throw new Error(c.statusText);case 18:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),E=function(){var e=n(s.mark((function e(t,a){var r,n;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(t.url.auth,"/api/user/").concat(a),e.next=3,fetch(r,{headers:f()});case 3:if(200!==(n=e.sent).status){e.next=8;break}return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:if(404!==n.status){e.next=10;break}return e.abrupt("return",null);case 10:if(e.t0=401===n.status,!e.t0){e.next=15;break}return e.next=14,b(t);case 14:e.t0=e.sent;case 15:if(!e.t0){e.next=19;break}return e.next=18,E(t,a);case 18:return e.abrupt("return",e.sent);case 19:throw new Error(n.statusText);case 20:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),N=function(){var e=n(s.mark((function e(t,a,n){var i,l;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="".concat(t.url.auth,"/api/user/").concat(a),e.next=3,fetch(i,{method:"PUT",headers:f(),body:JSON.stringify(n)});case 3:if(200!==(l=e.sent).status){e.next=10;break}return e.next=7,l.json();case 7:return t=e.sent,a=c(),e.abrupt("return",(o(r(r({},t),{},{token:a.token,refreshToken:a.refreshToken})),t));case 10:if(e.t0=401===l.status,!e.t0){e.next=15;break}return e.next=14,b(t);case 14:e.t0=e.sent;case 15:if(!e.t0){e.next=19;break}return e.next=18,N(t,a,n);case 18:return e.abrupt("return",e.sent);case 19:throw new Error(l.statusText);case 20:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),P={url:{store:"https://stored.azurewebsites.net",auth:"https://storeauth.azurewebsites.net",mail:"https://storemail.azurewebsites.net"},key:null};let F=P;const L=e=>{F=r(r({},P),e)},R=()=>F,M={postFile:e=>w(F,e),getFile:e=>k(F,e),delFile:e=>y(F,e),getById:(e,t)=>((e,t,a)=>{const r="".concat(e.url.store,"/api/store/").concat(t);return x(e,r,a)})(F,e,t),get:(e,t,a,r,s)=>((e,t,a=u,r=p,s=d,n=h)=>{const i="".concat(e.url.store,"/api/store/").concat(t);return m(e,i,a,r,s,n)})(F,e,t,a,r,s),put:(e,t,a)=>((e,t,a,r)=>{const s="".concat(e.url.store,"/api/store/").concat(t);return j(e,s,a,r)})(F,e,t,a),post:(e,t)=>((e,t,a)=>{const r="".concat(e.url.store,"/api/store/").concat(t);return v(e,r,a)})(F,e,t),delById:(e,t)=>((e,t,a)=>{const r="".concat(e.url.store,"/api/store/").concat(t);return g(e,r,a)})(F,e,t),del:(e,t)=>((e,t,a)=>{const r="".concat(e.url.store,"/api/store/").concat(t);return O(e,r,a)})(F,e,t),aggregation:(e,t,a,r,s)=>C(F,e,t,a,r,s),getLocation:()=>new Promise(((e,t)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition((t=>{const a={type:"Point",coordinates:[t.coords.latitude,t.coords.longitude]};e(a)}),(e=>{let a;switch(e.code){case e.PERMISSION_DENIED:a="User denied the request for Geolocation.";break;case e.POSITION_UNAVAILABLE:a="Location information is unavailable.";break;case e.TIMEOUT:a="The request to get user location timed out.";break;case e.UNKNOWN_ERROR:default:a="An unknown error occurred."}t(new Error(a))})):t("Geolocation is not supported by this browser.")}))},A={auth:(e,t,a)=>function(){var e=n(s.mark((function e(t,a,r,n=""){var i,c;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="".concat(t.url.auth,"/api/user/auth"),e.next=3,fetch(i,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:a,password:r,token:n})});case 3:if(200!==(c=e.sent).status){e.next=9;break}return e.next=7,c.json();case 7:return t=e.sent,e.abrupt("return",(o(t),t));case 9:if(401!==c.status){e.next=11;break}return e.abrupt("return",null);case 11:throw new Error(c.statusText);case 12:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}()(F,e,t,a),oAuth:(e,t,a,r)=>function(){var e=n(s.mark((function e(t,a,r,n,i=null){var c,l;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="".concat(t.url.auth,"/api/user/oauth"),e.next=3,fetch(c,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({provider:a,code:r,redirect_uri:n,config:i})});case 3:if(200!==(l=e.sent).status){e.next=9;break}return e.next=7,l.json();case 7:return t=e.sent,e.abrupt("return",(o(t),t));case 9:if(401!==l.status){e.next=11;break}return e.abrupt("return",null);case 11:throw new Error(l.statusText);case 12:case"end":return e.stop()}}),e)})));return function(t,a,r,s){return e.apply(this,arguments)}}()(F,e,t,a,r),reset:(e,t)=>function(){var e=n(s.mark((function e(t,a,r){var n,i;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(t.url.auth,"/api/user/reset"),e.next=3,fetch(n,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:a,redirectUri:r})});case 3:if(200===(i=e.sent).status){e.next=6;break}throw new Error(i.statusText);case 6:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}()(F,e,t),updateOauth:(e,t,a)=>S(F,e,t,a),generateSecret:()=>T(F),sign:e=>D(F,e),verify:(e,t)=>I(F,e,t),getUsers:(e,t,a)=>_(F,e,t,a),getUserCached:e=>function(){var e=n(s.mark((function e(t,a){var r,n,i,c,o;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="user/"+a,e.next=3,caches.open("kd-cache");case 3:return n=e.sent,e.next=6,n.match(r);case 6:if(!(i=e.sent)){e.next=11;break}return e.next=10,i.json();case 10:return e.abrupt("return",e.sent);case 11:return c="".concat(t.url.auth,"/api/user/").concat(a),e.next=14,fetch(c,{headers:f()});case 14:if(200!==(o=e.sent).status){e.next=20;break}return n.put(r,o.clone()),e.next=19,o.json();case 19:return e.abrupt("return",e.sent);case 20:if(404!==o.status){e.next=22;break}return e.abrupt("return",null);case 22:if(e.t0=401===o.status,!e.t0){e.next=27;break}return e.next=26,b(t);case 26:e.t0=e.sent;case 27:if(!e.t0){e.next=31;break}return e.next=30,E(t,a);case 30:return e.abrupt("return",e.sent);case 31:throw new Error(o.statusText);case 32:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()(F,e),getUser:e=>E(F,e),updateUser:(e,t)=>N(F,e,t),register:e=>function(){var e=n(s.mark((function e(t,a){var r,n;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(t.url.auth,"/api/user"),e.next=3,fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)});case 3:if(200!==(n=e.sent).status){e.next=8;break}return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:throw new Error(n.statusText);case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()(F,e),checkUser:e=>function(){var e=n(s.mark((function e(t,a){var r,n;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(t.url.auth,"/api/user/check?username=").concat(a),e.next=3,fetch(r,{headers:{Accept:"application/json","Content-Type":"application/json"}});case 3:if(200!==(n=e.sent).status){e.next=8;break}return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:throw new Error(n.statusText);case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()(F,e),subscribe:e=>function(){var e=n(s.mark((function e(t,a){var r,n;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(t.url.auth,"/api/user/subscriber"),e.next=3,fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)});case 3:if(200!==(n=e.sent).status){e.next=8;break}return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:throw new Error(n.statusText);case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()(F,e)},U={getById:(e,t)=>x(F,e,t),get:(e,t,a,r,s)=>m(F,e,t,a,r,s),put:(e,t,a)=>j(F,e,t,a),post:(e,t)=>v(F,e,t),delById:(e,t)=>g(F,e,t),del:(e,t)=>O(F,e,t)},W={send:e=>((e,t)=>{const a="".concat(e.url.mail,"/api/mail");return v(e,a,t)})(F,e)}}},t={};function a(r){if(t[r])return t[r].exports;var s=t[r]={exports:{}};return e[r](s,s.exports,a),s.exports}return a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a(129)})()},24:function(e){e.exports=JSON.parse('{"url":{"store":"https://kdvps.vps.wbsprt.com:8002","auth":"https://kdvps.vps.wbsprt.com:8001"},"github":{"id":"c426e790821064328634"},"google":{"id":"548560778490-kpllp0k9fhf7bdkfvlbjl0p4m88t0ipt.apps.googleusercontent.com"},"_strava":{"id":"39689"},"_fb":{"id":"719665785361475"},"2fa":false,"home":"/records","_configId":"5c606e8afb6fc06f052da3c9","_header":"/img/header.jpg","logo":"/img/logo.jpg","palette":{"type":"light","primary":{"main":"#de1220"},"secondary":{"main":"#050505"}},"locale":"en-US","passwordPattern":"^.{4,}$"}')},288:function(e){e.exports=JSON.parse('{"table":{"of":"of","rowsPerPage":"Rows per page:","previosPage":"Previous Page","nextPage":"Next Page","delete":"Delete","sure":"Are you sure?","selected":"Selected","filter":"Filter list","export":"Export","refresh":"Refresh list","sort":"Sort","edit":"Edit"},"toolbar":{"account":"Account","open":"Open drawer"},"form":{"save":"Save"},"dialog":{"ok":"Ok","cancel":"Cancel"}}')},289:function(e){e.exports=JSON.parse('{"table":{"of":"z","rowsPerPage":"Z\xe1znamov:","previosPage":"Predch\xe1dzaj\xfaca strana","nextPage":"Nasleduj\xfaca strana","delete":"Zmaza\u0165","sure":"Ste si ist\xfd?","selected":"zvolen\xfdch","filter":"Filtrova\u0165","export":"Exportova\u0165","refresh":"Obnovi\u0165","sort":"Triedi\u0165","edit":"Upravi\u0165"},"toolbar":{"account":"\xda\u010det","open":"Otvori\u0165"},"form":{"save":"Ulo\u017ei\u0165"},"dialog":{"ok":"Potvrdi\u0165","cancel":"Zru\u0161i\u0165"}}')},345:function(e){e.exports=JSON.parse('{"route":{"records":"Records","clients":"Clients","projects":"Projects","reports":"Reports","events":"Events","enums":"Enums","calendar":"Calendar","sign":"Sign data","verify":"Verify data","project":"Project","login":"Login","oauth":"Auth","tags":"Tags","activities":"Activities","account":"Account"},"field":{"name":"Name","email":"Email","username":"Username","password":"Password","repeatedPassword":"Password again","otp":"2FA","token":"Token","key":"Key","enumTypeId":"Type","disabled":"Disabled","address":"Address","city":"City","postCode":"Post code","country":"Country","tel":"Telephone contact","emailInUse":"Email is used by another user","usernameInUse":"Username is used by another user","passwordWeak":"Password must contains at least 4 characters","passwordNoMatch":"Passwords not matched","assignedToId":"Assignet to","stateId":"State","typeId":"Type","collaborators":"Collaborators","date":"Date","project":"Project","projectId":"Project","taskId":"Task","userId":"User","duration":"Duration"},"activities":"Activities","typeId":"Type","opId":"Stats","groupId":"Group","months":"Months","years":"Years","user":"User","distance":"Distance","elevation":"Elevation","time":"Time","count":"Count","kudos":"Kudos","value":"Value","club":"Club","sex":"Sex","sync":"Sync","connect":"Connect","connected":"Connected apps","generateSecret":"Generate secret","secret":"Secret","signIn":"Sign In","stravaSignIn":"Sign in with Strava","googleSignIn":"Sign in with Google","githubSignIn":"Sign in with Github","fbSignIn":"Sign in with FB","useAccount":"or use your account","totalDistance":"Total distance","totalElevation":"Total elevation","totalTime":"Total time","totalKudos":"Total kudos","maxDistance":"Max distance","maxElevation":"Max elevation","maxTime":"Max time","maxKudos":"Max kudos","thisWeek":"This week","lastWeek":"Last week","thisMonth":"This month","lastMonth":"Last month","thisYear":"This year","myMonths":"My months","myYears":"My years","all":"All","ride":"Ride","run":"Run","walk":"Walk","hike":"Hike","lastSync":"last sync","rideDes":"* bike distance calc as distance * 0.33","loading":"loading...","enums":"Enums","enum":"Enum"}')},346:function(e){e.exports=JSON.parse('{"route":{"records":"Z\xe1znamy","clients":"Klienti","projects":"Projekty","reports":"Reporty","events":"Udalosti","enums":"\u010c\xedseln\xedky","calendar":"Kalend\xe1r","sign":"Podp\xedsa\u0165 d\xe1ta","verify":"Overi\u0165 d\xe1ta","project":"Projekt","login":"Prihl\xe1senie","oauth":"Autentifik\xe1cia","tags":"Zna\u010dky","activities":"Aktivity","account":"\xda\u010det"},"field":{"name":"Meno","email":"Email","username":"Meno","password":"Heslo","repeatedPassword":"Heslo znova","otp":"2FA","token":"Token","key":"K\u013e\xfa\u010d","enumTypeId":"Typ","disabled":"Zru\u0161en\xe9","address":"Adresa","city":"Obec","postCode":"PS\u010c","country":"Krajina","tel":"Telef\xf3nny kontakt","emailInUse":"Zadan\xfd email u\u017e pou\u017e\xedva in\xfd pou\u017e\xedvate\u013e","usernameInUse":"Zadan\xe9 meno u\u017e pou\u017e\xedva in\xfd pou\u017e\xedvate\u013e","passwordWeak":"Heslo mus\xed obsahova\u0165 aspo\u0148 4 znaky","passwordNoMatch":"Hesl\xe1 sa nezhoduj\xfa","assignedToId":"Priraden\xe9","stateId":"Stav","typeId":"Typ","collaborators":"Spolupracovn\xedci","date":"D\xe1tum","projectId":"Projekt","taskId":"\xdaloha","userId":"U\u017e\xedvate\u013e","duration":"Trvanie"},"activities":"Activity","typeId":"Typ","opId":"\u0160tatistiky","groupId":"Grupa","months":"Mesiace","years":"Roky","user":"Pou\u017e\xedvate\u013e","distance":"Vzdialenos\u0165","elevation":"V\xfd\u0161ka","time":"\u010cas","count":"Po\u010det","kudos":"Kudos","value":"Hodnota","club":"Klub","sex":"Pohlavie","sync":"Sync","connect":"Prepojenie","connected":"Prepojen\xe9 aplik\xe1cie","generateSecret":"Generova\u0165 secret","secret":"Secret","token":"Token","signIn":"Prihl\xe1senie","stravaSignIn":"Prihl\xe1senie so Strava","googleSignIn":"Prihl\xe1senie s Google","githubSignIn":"Prihl\xe1senie s Github","fbSignIn":"Prihl\xe1senie s FB","useAccount":"alebo pou\u017eite svoj \xfa\u010det","totalDistance":"Celkov\xe1 vzdialenos\u0165","totalElevation":"Celkov\xe1 v\xfd\u0161ka","totalTime":"Celkov\xfd \u010das","totalKudos":"Celkom kudos","maxDistance":"Maxim\xe1lna vzdielenos\u0165","maxElevation":"Maxim\xe1lna v\xfd\u0161ka","maxTime":"Maxim\xe1lny \u010das","maxKudos":"Maximum kudos","thisWeek":"Tento t\xfd\u017ede\u0148","lastWeek":"Minul\xfd t\xfd\u017ede\u0148","thisMonth":"Tento mesiac","lastMonth":"Minul\xfd mesiac","thisYear":"Tento rok","myMonths":"Moje mesiace","myYears":"Moje roky","all":"V\u0161etky","ride":"Bicykel","run":"Beh","walk":"Ch\xf4dza","hike":"Turistika","lastSync":"posledn\xe1 synchroniz\xe1cia","rideNote":"* vzdialenos\u0165 prejden\xe1 na bicykli r\xe1tan\xe1 ako vzdialenos\u0165 * 0.33","loading":"na\u010d\xedtavanie...","enums":"\u010c\xedseln\xedky","enum":"\u010c\xedseln\xedk"}')},376:function(e,t,a){},723:function(e,t,a){},745:function(e,t,a){"use strict";a.r(t);var r=a(2),s=a(1),n=a.n(s),i=a(38),c=a.n(i),o=(a(376),a(9)),l=a(347),u=a(143),d=a(41),p=a(340),h=a.n(p),f=a(33),b=a.n(f),x=a(341),m=a.n(x),j=a(11),v=a.n(j);function g(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce(((e,t)=>(...a)=>e(t(...a))))}var O=n.a.createContext();var w=e=>t=>Object(r.jsx)(O.Consumer,{children:a=>Object(r.jsx)(e,Object(o.a)(Object(o.a)({},t),{},{user:a}))}),k=a(292),y=a.n(k),C=a(98),S=a.n(C),T=a(290),D=a.n(T),I=a(193),_=a.n(I),E=a(192),N=a.n(E),P=a(115),F=a.n(P),L=a(116),R=a.n(L),M=a(97),A=a.n(M),U=a(293),W=a.n(U),q=a(66),z=a.n(q),B=a(28),V=a.n(B),J=a(294),K=a.n(J),H=a(67),Y=a.n(H),G=a(146),Z=a.n(G),X=a(8),$=a(144),Q=a.n($),ee=a(288),te=a(289);const ae=n.a.createContext();class re extends n.a.Component{constructor(e){super(e),this.translate=e=>t=>{const a=t.split(".");let r=this.locales[e][a[0]];return a.length>1&&(r=r[a[1]]),r},this.locales={"en-US":Object(o.a)(Object(o.a)({},ee),e["en-US"]),"sk-SK":Object(o.a)(Object(o.a)({},te),e["sk-SK"])},this.state={locale:e.locale||"en-US"}}render(){const e=this.props.children;return Object(r.jsx)(ae.Provider,{value:{locale:this.state.locale,translate:this.translate(this.state.locale)},children:e})}}const se=e=>t=>Object(r.jsx)(ae.Consumer,{children:a=>Object(r.jsx)(e,Object(o.a)(Object(o.a)({},t),a))}),ne=240;class ie extends n.a.Component{constructor(e){super(e),this.handleMenu=e=>{this.setState({anchorEl:e.currentTarget})},this.handleClose=()=>{this.setState({anchorEl:null})},this.handleClickAccount=()=>{this.props.history.push("/account"),this.handleClose()},this.handleDrawerToggle=()=>{this.setState((e=>({mobileOpen:!e.mobileOpen})))},this.redirect=e=>{Object($.isWidthDown)("md",this.props.width)&&this.handleDrawerToggle(),this.props.history.push(e.path)},this.state={mobileOpen:!1,anchorEl:null}}render(){const e=this.props,t=e.classes,a=e.theme,s=e.routes,n=e.user,i=e.translate,c=this.state.anchorEl,o=Boolean(c),l=this.props.history.location.pathname,u=s.find((e=>e.path===l)),d=Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:t.toolbar}),Object(r.jsx)(D.a,{}),Object(r.jsx)(F.a,{children:s.map((e=>!e.exact||e.hidden||e.permission&&!n.hasPermission(e.permission)?null:Object(r.jsx)(R.a,{button:!0,onClick:()=>this.redirect(e),children:Object(r.jsx)(A.a,{primary:i("route."+e.name)||e.name})},e.name)))})]});return u&&u.anonymous?Object(r.jsx)("div",{className:t.root,children:this.props.children}):Object(r.jsxs)("div",{className:t.root,children:[Object(r.jsx)(S.a,{}),Object(r.jsx)(y.a,{position:"fixed",className:t.appBar,color:"secondary",children:Object(r.jsxs)(z.a,{children:[Object(r.jsx)(b.a,{color:"inherit","aria-label":i("toolbar.open"),onClick:this.handleDrawerToggle,className:t.menuButton,children:Object(r.jsx)(W.a,{})}),Object(r.jsx)(V.a,{variant:"h6",color:"inherit",noWrap:!0,className:t.grow,children:u?i("route."+u.name)||u.name:"App"}),Object(r.jsxs)("div",{children:[Object(r.jsx)("span",{children:n.user?n.user.name:null}),Object(r.jsx)(b.a,{"aria-owns":o?"menu-appbar":void 0,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit",children:Object(r.jsx)(K.a,{})}),Object(r.jsx)(Z.a,{id:"menu-appbar",anchorEl:c,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:o,onClose:this.handleClose,children:Object(r.jsx)(Y.a,{onClick:this.handleClickAccount,children:i("toolbar.account")})})]})]})}),Object(r.jsxs)("nav",{className:t.drawer,children:[Object(r.jsx)(N.a,{lgUp:!0,implementation:"css",children:Object(r.jsx)(_.a,{variant:"temporary",anchor:"rtl"===a.direction?"right":"left",open:this.state.mobileOpen,onClose:this.handleDrawerToggle,classes:{paper:t.drawerPaper},children:d})}),Object(r.jsx)(N.a,{mdDown:!0,implementation:"css",children:Object(r.jsx)(_.a,{classes:{paper:t.drawerPaper},variant:"permanent",open:!0,children:d})})]}),Object(r.jsxs)("main",{className:t.content,children:[Object(r.jsx)("div",{className:t.toolbar}),this.props.children]})]})}}var ce=g(Q()(),Object(X.withStyles)((e=>({root:{display:"flex"},grow:{flexGrow:1},drawer:{[e.breakpoints.up("lg")]:{width:ne,flexShrink:0}},appBar:{marginLeft:ne,[e.breakpoints.up("lg")]:{width:"calc(100% - ".concat(ne,"px)")}},menuButton:{marginRight:20,[e.breakpoints.up("lg")]:{display:"none"}},toolbar:e.mixins.toolbar,drawerPaper:{width:ne},content:{flexGrow:1,padding:2*e.spacing.unit,overflow:"auto"}})),{withTheme:!0}),d.f,se)(ie),oe=a(21),le=a.n(oe),ue=a(20),de=a.n(ue),pe=a(4),he=a.n(pe),fe=a(6),be=a(103);var xe=se(Object(X.withStyles)((e=>({formControl:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit,minWidth:160}})))((function(e){const t=e.classes,a=(e=>{switch(e){case"sk-SK":return{format:"DD.M.YYYY",mask:[/\d/,/\d/,".",/\d/,".",/\d/,/\d/,/\d/,/\d/]};case"en-US":default:return{format:"MM/DD/YYYY",mask:[/\d/,/\d/,"/",/\d/,/\d/,"/",/\d/,/\d/,/\d/,/\d/]}}})(e.locale),s=a.format,n=a.mask,i=e.label||e.translate("field."+e.field);return Object(r.jsx)(be.a,{className:t.formControl,keyboard:!0,label:i,format:s,clearable:!e.required,mask:e=>e?n:[],value:e.value||null,onChange:t=>e.onChange(e.field,t?t.toDate():null),disableOpenOnEnter:!0,animateYearScrolling:!1,style:{flex:1,display:"flex"},disabled:e.disabled,okLabel:e.translate("dialog.ok"),cancelLabel:e.translate("dialog.cancel")})}))),me=a(54),je=a.n(me),ve=a(191),ge=a.n(ve),Oe=a(51),we=a.n(Oe),ke=a(53),ye=a.n(ke);var Ce=se(Object(X.withStyles)((e=>({formControl:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit,minWidth:100}})))((function(e){const t=e.classes,a=e.label||e.translate("field."+e.field);return Object(r.jsxs)(je.a,{className:t.formControl,fullWidth:e.fullWidth,required:e.required,error:e.errorText&&""!==e.errorText,style:{width:e.width},children:[Object(r.jsx)(ye.a,{htmlFor:e.field,children:a}),Object(r.jsx)(we.a,{type:"new-password"===e.type?"password":e.type,id:e.field,value:e.value||"",onChange:t=>e.onChange(e.field,t.target.value),placeholder:e.placeholder,autoComplete:"new-password"===e.type?"new-password":null,disabled:e.disabled,multiline:e.multiline,rows:e.rows,startAdornment:e.startAdornment,inputProps:{onBlur:e.onBlur}}),Object(r.jsx)(ge.a,{children:e.errorText})]})})));var Se=se(Object(X.withStyles)((e=>({formControl:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit,minWidth:80}})))((function(e){const t=e.classes,a=e.label||e.translate("field."+e.field);return Object(r.jsxs)(je.a,{className:t.formControl,required:e.required,fullWidth:e.fullWidth,style:{width:e.width},children:[Object(r.jsx)(ye.a,{htmlFor:e.field,children:a}),Object(r.jsx)(we.a,{id:e.field,value:e.value?e.value.toString():"0",onChange:t=>e.onChange(e.field,Number(t.target.value)),type:"number",disabled:e.disabled,inputProps:{min:e.min,max:e.max,step:e.step||"any"}})]})}))),Te=a(142),De=a.n(Te),Ie=a(99),_e=a.n(Ie);var Ee=se(Object(X.withStyles)((e=>({formControl:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit,minWidth:120}})))((function(e){const t=e.classes,a=e.data,s=e.textField,n=e.required,i=e.value,c=e.onChange,o=e.field,l=e.multiple;n&&null===i&&a&&a.length>0&&c(o,a[0]._id);const u=e=>{const t=a.find((t=>t._id===e));return t?t[s]:null},d=e.label||e.translate("field."+e.field);return Object(r.jsxs)(je.a,{className:t.formControl,required:n,fullWidth:e.fullWidth,children:[d&&Object(r.jsx)(ye.a,{htmlFor:e.field,children:d}),Object(r.jsxs)(De.a,{value:null!==e.value?e.value:"",onChange:t=>c(e.field,t.target.value),id:e.field,multiple:e.multiple,renderValue:e=>l?e.map((e=>u(e))).join(" | "):u(e),disabled:e.disabled,children:[!e.required&&!l&&Object(r.jsx)(Y.a,{value:"",children:Object(r.jsx)("em",{children:"None"})}),a.map((e=>Object(r.jsxs)(Y.a,{value:e._id,children:[l&&Object(r.jsx)(_e.a,{checked:void 0!==i.find((t=>t===e._id))}),Object(r.jsx)(A.a,{primary:e[s]})]},e._id)))]})]})}))),Ne=a(31),Pe=a.n(Ne);class Fe extends n.a.Component{constructor(...e){super(...e),this.handleChange=(e,t)=>{this.setState({[e]:t})},this.handleSubmit=e=>{e.preventDefault(),this.props.onSubmit()}}render(){const e=this.props,t=e.classes,a=e.inline,s=e.disabled,n=e.translate;return Object(r.jsxs)("form",{className:a?t.formInline:t.form,onSubmit:this.handleSubmit,children:[this.props.children,!s&&Object(r.jsx)(Pe.a,{className:t.submitButton,type:"submit",variant:"contained",color:"primary",disabled:s,children:n("form.save")})]})}}var Le=se(Object(X.withStyles)((e=>({formInline:{display:"flex",flexWrap:"wrap",flexDirection:"row"},form:{display:"flex",flexDirection:"column"},submitButton:{margin:e.spacing.unit,marginBottom:2*e.spacing.unit}})))(Fe));var Re=n.a.createContext();var Me=e=>t=>Object(r.jsx)(Re.Consumer,{children:a=>Object(r.jsx)(e,Object(o.a)(Object(o.a)({},t),{},{store:a}))});const Ae={date:new Date,name:"",duration:0,projectId:null,taskId:null};class Ue extends n.a.Component{constructor(...e){var t;super(...e),t=this,this.state=this.props.data||Ae,this.handleChangeProject=(e,t)=>{const a=this.props.user.user,r=this.props.store,s=r.getOpenedTasks,n=r.handleChange;s(t,a),this.props.data||n(e,t),this.handleChange(e,t)},this.handleChange=(e,t)=>{this.setState({[e]:t})},this.handleSubmit=Object(fe.a)(he.a.mark((function e(){var a,r,s,n,i;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.store,r=a.addTimeRecord,s=a.refreshTimeRecords,n=a.editTimeRecord,i=t.props.user.user,t.state.projectId){e.next=4;break}return e.abrupt("return");case 4:if(e.prev=4,!t.state._id){e.next=10;break}return e.next=8,n(t.state,i);case 8:e.next=12;break;case 10:return e.next=12,r(t.state,i);case 12:s(),t.setState(Ae),t.props.onSubmit&&t.props.onSubmit(),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),t.props.user.showError(e.t0);case 20:case"end":return e.stop()}}),e,null,[[4,17]])})))}render(){const e=this.props.classes,t=this.state,a=t.date,s=t.name,n=t.duration,i=t.projectId,c=t.taskId,o=this.props.store,l=o.projects,u=o.tasks;return Object(r.jsxs)(Le,{onSubmit:this.handleSubmit,inline:!0,children:[Object(r.jsx)("div",{className:e.nameTextInput,children:Object(r.jsx)(Ce,{value:s,field:"name",onChange:this.handleChange,fullWidth:!0,required:!0})}),Object(r.jsx)(Ee,{value:i,field:"projectId",onChange:this.handleChangeProject,data:l.data,textField:"name",required:!0}),Object(r.jsx)(Ee,{value:c,field:"taskId",onChange:this.handleChange,data:u.data,textField:"name"}),Object(r.jsx)(xe,{value:a,field:"date",onChange:this.handleChange,required:!0}),Object(r.jsx)(Se,{value:n,field:"duration",onChange:this.handleChange,min:0,step:.25,required:!0})]})}}var We=g(Object(X.withStyles)((e=>({nameTextInput:{display:"flex",flex:1}}))),Me,w)(Ue),qe=a(308),ze=a.n(qe),Be=a(309),Ve=a.n(Be),Je=a(60),Ke=a.n(Je),He=a(310),Ye=a.n(He),Ge=a(117),Ze=a.n(Ge),Xe=a(300),$e=a.n(Xe),Qe=a(301),et=a.n(Qe),tt=a(42),at=a.n(tt);class rt extends n.a.Component{constructor(...e){super(...e),this.createSortHandler=e=>t=>{this.props.onRequestSort(t,e)}}render(){const e=this.props,t=e.onSelectAllClick,a=e.sort,s=e.numSelected,n=e.rowCount,i=e.rows,c=e.sortable,o=e.translate;return Object(r.jsx)($e.a,{children:Object(r.jsxs)(Ze.a,{children:[Object(r.jsx)(Ke.a,{padding:"checkbox",children:Object(r.jsx)(_e.a,{indeterminate:s>0&&s<n,checked:s===n,onChange:t})}),i.map((e=>{const t=e.label||o("field.".concat(e.idField||e.field));return Object(r.jsx)(Ke.a,{align:"num"===e.type?"right":"left",padding:e.disablePadding?"none":"default",sortDirection:a.field===e.field&&a.dir,children:!1===c||!1===e.sortable?t:Object(r.jsx)(at.a,{title:o("table.sort"),placement:"num"===e.type?"bottom-end":"bottom-start",enterDelay:300,children:Object(r.jsx)(et.a,{active:a.field===e.field,direction:a.dir,onClick:this.createSortHandler(e.field),children:t})})},e.field)}),this),Object(r.jsx)(Ke.a,{padding:"none"})]})})}}var st=se(rt),nt=a(7),it=a.n(nt),ct=a(302),ot=a.n(ct),lt=a(303),ut=a.n(lt),dt=a(148),pt=a.n(dt),ht=a(149),ft=a.n(ht),bt=a(58);var xt=se(Object(X.withStyles)((e=>({root:{paddingRight:e.spacing.unit},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(bt.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 auto"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}})))((e=>{const t=e.numSelected,a=e.classes,s=e.onDelete,n=e.onFilter,i=e.title,c=e.onExport,o=e.isFilterSet,l=e.actions,u=e.onRefresh,d=e.exportDisabled,p=e.translate;return Object(r.jsxs)(z.a,{className:it()(a.root,{[a.highlight]:t>0}),children:[Object(r.jsx)("div",{className:a.title,children:t>0?Object(r.jsxs)(V.a,{color:"inherit",variant:"subtitle1",children:[t," ",p("table.selected")]}):Object(r.jsx)(V.a,{variant:"h6",id:"tableTitle",children:i})}),Object(r.jsx)("div",{className:a.spacer}),Object(r.jsxs)("div",{className:a.actions,children:[l,t>0?Object(r.jsx)(at.a,{title:p("table.delete"),children:Object(r.jsx)(b.a,{"aria-label":p("table.delete"),onClick:s,children:Object(r.jsx)(ot.a,{})})}):Object(r.jsx)(at.a,{title:p("table.filter"),children:Object(r.jsx)(b.a,{"aria-label":p("table.filter"),color:o?"primary":"default",onClick:n,children:Object(r.jsx)(pt.a,{})})}),Object(r.jsx)(at.a,{title:p("table.export"),children:Object(r.jsx)(b.a,{"aria-label":p("table.export"),onClick:c,disabled:d,children:Object(r.jsx)(ut.a,{})})}),Object(r.jsx)(at.a,{title:p("table.refresh"),children:Object(r.jsx)(b.a,{"aria-label":p("table.refresh"),onClick:u,children:Object(r.jsx)(ft.a,{})})})]})]})}))),mt=a(59),jt=a.n(mt),vt=a(75),gt=a.n(vt),Ot=a(147),wt=a.n(Ot),kt=a(304),yt=a.n(kt),Ct=a(76),St=a.n(Ct);var Tt=se((function(e){return Object(r.jsxs)(jt.a,{open:e.isOpen,onClose:e.onClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(r.jsx)(St.a,{id:"alert-dialog-title",children:e.title}),Object(r.jsx)(wt.a,{children:Object(r.jsx)(yt.a,{id:"alert-dialog-description",children:e.description})}),Object(r.jsxs)(gt.a,{children:[Object(r.jsx)(Pe.a,{onClick:e.onClose,color:"primary",children:e.translate("dialog.cancel")}),Object(r.jsx)(Pe.a,{onClick:e.onConfirm,color:"primary",autoFocus:!0,children:e.translate("dialog.ok")})]})]})})),Dt=a(19),It=a.n(Dt);const _t=(e,t,a)=>{const r=[];if(a){let s,n;t.forEach((e=>{n=e.field,s=a[n],s&&r.push(...e.data.find((e=>e._id===s)).filters)})),e.forEach((e=>{switch(e.type){case"num":n=e.field,s=a[n],s&&r.push({field:n,op:"eq",value:s});break;case"bool":n=e.field,s=a[n],s&&r.push({field:n,op:"eq",value:1===s});break;case"date":case"datetime":n=e.field,s=a[n],s&&(r.push({field:n,op:"lte",value:It()(s).endOf("day").toDate()}),r.push({field:n,op:"gte",value:It()(s).startOf("day").toDate()}));break;case"enum":case"array":n=e.idField,s=a[n],s&&s.length>0&&r.push({field:n,op:"in",value:s});break;default:n=e.field,s=a[n],s&&r.push({field:n,op:"regex",value:s})}}))}return r};class Et extends n.a.Component{constructor(e){super(e),this.handleChange=(e,t)=>{this.setState({[e]:t})},this.handleClear=()=>{const e={};this.props.filters.forEach((t=>{e[t.field]=null})),this.props.rows.forEach((t=>{const a="enum"===t.type||"array"===t.type?t.idField:t.field;e[a]=null})),this.props.onConfirm(null),this.setState(e)},this.handleSubmit=()=>{this.props.onConfirm(this.state)},this.buildFilter=e=>{if(!1===e.filterable)return null;switch(e.type){case"enum":case"array":const t=e.textField||e.field.split(".").pop(),a=this.props.store[e.data].data;return Object(r.jsx)(Ee,{label:e.label,value:this.state[e.idField]||[],field:e.idField,onChange:this.handleChange,data:e.getData?e.getData(a):a,textField:t,multiple:!0},e.field);case"bool":return Object(r.jsx)(Ee,{label:e.label,value:this.state[e.field],field:e.field,onChange:this.handleChange,data:[{_id:1,name:"T"},{_id:-1,name:"F"}],textField:"name"},e.field);case"date":case"datetime":return Object(r.jsx)(xe,{label:e.label,value:this.state[e.field],field:e.field,onChange:this.handleChange},e.field);case"num":return Object(r.jsx)(Se,{label:e.label,value:this.state[e.field],field:e.field,onChange:this.handleChange,min:0},e.field);default:return Object(r.jsx)(Ce,{label:e.label,value:this.state[e.field],field:e.field,onChange:this.handleChange},e.field)}},this.state=e.defaultState||{}}render(){const e=this.props;return Object(r.jsxs)(jt.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:e.isOpen,onClose:e.onClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0,children:[Object(r.jsx)(St.a,{id:"alert-dialog-title",children:"Filters"}),this.props.filters.map((e=>Object(r.jsx)(Ee,{value:this.state[e.field],field:e.field,label:e.label,onChange:this.handleChange,data:e.data,textField:"name"}))),e.rows.map((e=>this.buildFilter(e))),Object(r.jsxs)(gt.a,{children:[Object(r.jsx)(Pe.a,{onClick:this.handleClear,color:"primary",children:"Clear"}),Object(r.jsx)(Pe.a,{onClick:this.handleSubmit,color:"primary",autoFocus:!0,children:"OK"})]})]})}}var Nt=Et,Pt=a(305),Ft=a.n(Pt);class Lt extends n.a.Component{constructor(...e){super(...e),this.state={anchorEl:null,isOpenDelete:!1},this.handleOpenMenu=e=>{this.setState({anchorEl:e.currentTarget})},this.handleCloseMenu=()=>{this.setState({anchorEl:null})},this.handleCloseDelete=()=>{this.setState({isOpenDelete:!1})},this.handleOpenDelete=()=>{this.setState({isOpenDelete:!0,anchorEl:null})},this.onDelete=()=>{this.props.onDelete(),this.handleCloseDelete()},this.onEdit=()=>{this.props.onEdit(),this.handleCloseMenu()}}render(){const e=this.state,t=e.anchorEl,a=e.isOpenDelete,s=this.props.translate;return Object(r.jsxs)("div",{children:[Object(r.jsx)(b.a,{"aria-owns":t?"actions-menu":void 0,"aria-haspopup":"true",edge:"end","aria-label":"actions",onClick:this.handleOpenMenu,disabled:this.props.disabled,children:Object(r.jsx)(Ft.a,{})}),Object(r.jsxs)(Z.a,{id:"actions-menu",anchorEl:t,open:Boolean(t),onClose:this.handleCloseMenu,children:[Object(r.jsx)(Y.a,{onClick:this.onEdit,children:s("table.edit")}),Object(r.jsx)(Y.a,{onClick:this.handleOpenDelete,children:s("table.delete")})]}),Object(r.jsx)(Tt,{isOpen:a,onClose:this.handleCloseDelete,onConfirm:this.onDelete,title:s("table.delete"),description:s("table.sure")})]})}}var Rt=se(Lt),Mt=a(306),At=a.n(Mt);var Ut=Object(X.withStyles)((e=>({progress:{backgroundColor:"white",opacity:.8,position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1800,display:"flex",justifyContent:"center",alignItems:"center"}})))((function(e){const t=e.classes;return e.isLoading?Object(r.jsx)("div",{className:t.progress,children:Object(r.jsx)(At.a,{})}):null})),Wt=a(307),qt=a(43),zt=a.n(qt);let Bt=[];class Vt extends n.a.Component{constructor(e){var t;super(e),t=this,this.handleRequestSort=(e,t)=>{const a=t;let r="desc";this.state.sort.field===t&&"desc"===this.state.sort.dir&&(r="asc");const s={field:a,dir:r},n=this.state,i=n.filters,c=n.page,o=n.rowsPerPage;this.onChange(i,c,o,s),this.setState({sort:s})},this.handleSelectAllClick=e=>{if(e.target.checked){const e=this.props.store[this.props.data].data;this.setState((t=>({selected:e.filter((e=>!1===this.props.isDisabled(e))).map((e=>e._id))})))}else this.setState({selected:[]})},this.handleClick=e=>{const t=this.state.selected,a=t.indexOf(e);let r=[];-1===a?r=r.concat(t,e):0===a?r=r.concat(t.slice(1)):a===t.length-1?r=r.concat(t.slice(0,-1)):a>0&&(r=r.concat(t.slice(0,a),t.slice(a+1))),this.setState({selected:r})},this.handleChangePage=(e,t)=>{const a=this.state,r=a.filters,s=a.rowsPerPage,n=a.sort;this.onChange(r,t,s,n),this.setState({page:t})},this.handleChangeRowsPerPage=e=>{const t=e.target.value,a=this.state,r=a.filters,s=a.page,n=a.sort;this.onChange(r,s,t,n),this.setState({rowsPerPage:t})},this.isSelected=e=>-1!==this.state.selected.indexOf(e),this.onChange=(e,t,a,r)=>{this.props.onChange(e,{limit:a,skip:a*t},r,!0)},this.componentDidMount=()=>{const e=this.state,t=e.filters,a=e.page,r=e.rowsPerPage,s=e.sort;this.onChange(t,a,r,s)},this.handleOpenFilter=()=>{this.setState({isOpenFilter:!0})},this.handleCloseFilter=()=>{this.setState({isOpenFilter:!1})},this.handleConfirmFilter=e=>{const t=_t(this.props.rows,this.props.filters,e),a=this.state,r=a.rowsPerPage,s=a.sort;this.onChange(t,0,r,s),this.setState({filters:t,page:0,isOpenFilter:!1})},this.onDeleteMultiple=Object(fe.a)(he.a.mark((function e(){var a,r,s,n,i,c;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.state,r=a.selected,s=a.filters,n=a.page,i=a.rowsPerPage,c=a.sort,e.next=3,Promise.all(r.map((e=>t.props.onDelete(e))));case 3:t.onChange(s,n,i,c),t.setState({selected:[]}),t.handleCloseDelete();case 6:case"end":return e.stop()}}),e)}))),this.strToDate=e=>new Date(e).toLocaleDateString(this.props.locale),this.strToDateTime=e=>new Date(e).toLocaleString(this.props.locale,{hour12:!1,year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"}),this.getValue=(e,t)=>{const a=zt.a.get(e,t.field);if(t.cell)return t.cell(e);switch(t.type){case"date":return this.strToDate(a);case"datetime":return this.strToDateTime(a);case"bool":return a?"T":"F";case"array":return a.map((e=>e[t.textField])).join(" | ");default:return a}},this.onDeleteSingle=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r,s,n,i,c;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.state,s=r.filters,n=r.page,i=r.rowsPerPage,c=r.sort,e.next=3,t.props.onDelete(a);case 3:t.onChange(s,n,i,c);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleCloseDelete=()=>{this.setState({isOpenDelete:!1})},this.handleOpenDelete=()=>{this.setState({isOpenDelete:!0})},this.onExport=Object(fe.a)(he.a.mark((function e(){var a,r,s,n;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.state,r=a.filters,s=a.sort,Bt=[],t.props.rows.forEach((e=>{if(!1!==e.exportable){const a=e.idField||e.field;Bt.push({label:t.props.translate("field."+a),key:e.field})}})),e.next=5,t.props.onChange(r,void 0,s,!1);case 5:(n=e.sent)&&(t.setState({exported:n.data}),t.exportRef.current.link.click());case 7:case"end":return e.stop()}}),e)}))),this.handleRefresh=()=>{const e=this.state,t=e.filters,a=e.page,r=e.rowsPerPage,s=e.sort;this.onChange(t,a,r,s,!0)},this.state={selected:[],page:0,rowsPerPage:5,filters:_t(e.rows,e.filters,e.defaultFilters),sort:e.defaultSort||{field:"_id",dir:"asc"},isOpenDelete:!1,isOpenFilter:!1,filter:null,exported:[]},this.exportRef=n.a.createRef()}render(){const e=this.props,t=e.classes,a=e.rows,s=e.sortable,n=e.title,i=e.translate,c=this.state,o=c.selected,l=c.rowsPerPage,u=c.page,d=c.sort,p=c.isOpenDelete,h=c.isOpenFilter,f=this.props.store[this.props.data],b=l-Math.min(l,f.total-u*l);return Object(r.jsxs)(de.a,{className:t.root,children:[Object(r.jsx)(xt,{numSelected:o.length,onDelete:this.handleOpenDelete,onExport:this.onExport,onFilter:this.handleOpenFilter,title:n,isFilterSet:this.state.filters.length>0,actions:this.props.actions,onRefresh:this.handleRefresh,exportDisabled:!this.props.filename}),Object(r.jsxs)("div",{className:t.tableWrapper,children:[Object(r.jsx)(Ut,{isLoading:f.isLoading}),Object(r.jsxs)(ze.a,{className:t.table,"aria-labelledby":"tableTitle",size:"small",children:[Object(r.jsx)(st,{numSelected:o.length,sort:d,onSelectAllClick:this.handleSelectAllClick,onRequestSort:this.handleRequestSort,rowCount:f.total,rows:a,sortable:s}),Object(r.jsxs)(Ve.a,{children:[f.data.map((e=>{const t=this.isSelected(e._id),s=this.props.isDisabled(e);return Object(r.jsxs)(Ze.a,{hover:!0,role:"checkbox","aria-checked":t,tabIndex:-1,selected:t,children:[Object(r.jsx)(Ke.a,{padding:"checkbox",children:Object(r.jsx)(_e.a,{checked:t,onClick:t=>this.handleClick(e._id),disabled:s})}),a.map((t=>Object(r.jsx)(Ke.a,{align:"num"===t.type?"right":"left",padding:t.disablePadding?"none":"default",children:this.getValue(e,t)},t.field))),Object(r.jsx)(Ke.a,{children:Object(r.jsx)(Rt,{onDelete:()=>this.onDeleteSingle(e._id),onEdit:()=>this.props.onEdit(e),disabled:s})})]},e._id)})),b>0&&Object(r.jsx)(Ze.a,{style:{height:49*b},children:Object(r.jsx)(Ke.a,{colSpan:6})})]})]})]}),Object(r.jsx)(Ye.a,{labelRowsPerPage:i("table.rowsPerPage"),labelDisplayedRows:({from:e,to:t,count:a})=>"".concat(e,"-").concat(t," ").concat(i("table.of")," ").concat(a),rowsPerPageOptions:[5,10,25],component:"div",count:f.total,rowsPerPage:l,page:u,backIconButtonProps:{"aria-label":i("table.previousPage")},nextIconButtonProps:{"aria-label":i("table.nextPage")},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}),Object(r.jsx)(Tt,{isOpen:p,onClose:this.handleCloseDelete,onConfirm:this.onDeleteMultiple,title:i("table.delete"),description:i("table.sure")}),Object(r.jsx)(Nt,{isOpen:h,onClose:this.handleCloseFilter,onConfirm:this.handleConfirmFilter,store:this.props.store,rows:this.props.rows,filters:this.props.filters,defaultState:this.props.defaultFilters}),Object(r.jsx)(Wt.CSVLink,{data:this.state.exported,headers:Bt,filename:this.props.filename+".csv",style:{display:"none"},ref:this.exportRef,target:"_blank"})]})}}var Jt=se(Object(X.withStyles)((e=>({root:{width:"100%"},table:{},tableWrapper:{overflowX:"auto",position:"relative"}})))(Vt));var Kt=Object(X.withStyles)((e=>({formControl:{margin:e.spacing.unit,width:160}})))((function(e){return Object(r.jsxs)(jt.a,{onClose:e.onClose,"aria-labelledby":"simple-dialog-title",open:e.isOpen,fullWidth:!0,children:[Object(r.jsx)(St.a,{id:"simple-dialog-title",children:e.title}),e.children]})}));const Ht=[{label:"Period",field:"period",data:[{_id:1,name:"today",filters:[{field:"date",op:"lte",value:It()().endOf("day").toDate()},{field:"date",op:"gte",value:It()().startOf("day").toDate()}]},{_id:2,name:"this week",filters:[{field:"date",op:"lte",value:It()().endOf("week").toDate()},{field:"date",op:"gte",value:It()().startOf("week").toDate()}]},{_id:3,name:"last week",filters:[{field:"date",op:"lte",value:It()().subtract(1,"weeks").endOf("week").toDate()},{field:"date",op:"gte",value:It()().subtract(1,"weeks").startOf("week").toDate()}]},{_id:4,name:"this month",filters:[{field:"date",op:"lte",value:It()().endOf("month").toDate()},{field:"date",op:"gte",value:It()().startOf("month").toDate()}]},{_id:5,name:"last month",filters:[{field:"date",op:"lte",value:It()().subtract(1,"month").endOf("month").toDate()},{field:"date",op:"gte",value:It()().subtract(1,"month").startOf("month").toDate()}]},{_id:6,name:"this year",filters:[{field:"date",op:"lte",value:It()().endOf("year").toDate()},{field:"date",op:"gte",value:It()().startOf("year").toDate()}]},{_id:7,name:"last year",filters:[{field:"date",op:"lte",value:It()().subtract(1,"year").endOf("month").toDate()},{field:"date",op:"gte",value:It()().subtract(1,"year").startOf("year").toDate()}]}]}];let Yt;class Gt extends n.a.Component{constructor(e){var t,a;super(e),t=this,this.handleClose=()=>{const e=this.props.user.user,t=this.props.store,a=t.projectId;(0,t.getOpenedTasks)(a,e),this.setState({isOpen:!1})},this.handleOpen=()=>{this.setState({isOpen:!0})},this.handleChange=function(){var e=Object(fe.a)(he.a.mark((function e(a,r,s){var n;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=[...t.props.filters,...a],e.next=4,t.props.store.getTimeRecords(n,r,s);case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(0),t.props.user.showError(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a,r){return e.apply(this,arguments)}}(),this.onEdit=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props.user.user,e.next=3,t.props.store.getOpenedTasks(a.projectId,r);case 3:t.setState({x:a,isOpen:!0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.isDisabled=e=>this.props.user.user._id!==e.userId,this.state={x:null,isOpen:!1},a=e.filters,Yt=[{field:"name",disablePadding:!0},{field:"date",type:"date"},{field:"_project.name",type:"enum",data:"projects",idField:"projectId"},{field:"_task.name",type:"enum",data:"tasks",idField:"taskId",filterable:!1},{field:"_user.name",type:"enum",data:"users",idField:"userId",filterable:void 0===a.find((e=>"userId"===e.field))},{field:"duration",type:"num",filterable:!1}]}componentDidMount(){var e=this;return Object(fe.a)(he.a.mark((function t(){return he.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{e.props.store.getClients()}catch(a){e.props.user.showError(a)}case 1:case"end":return t.stop()}}),t)})))()}render(){const e=this.props.store.deleteTimeRecord;return Object(r.jsxs)("div",{children:[Object(r.jsx)(Jt,{rows:Yt,data:"timeRecords",onChange:this.handleChange,sortable:!1,onDelete:e,title:"Time records",onEdit:this.onEdit,store:this.props.store,filters:Ht,defaultFilters:this.props.defaultFilters,isDisabled:this.isDisabled,filename:"records"}),Object(r.jsx)(Kt,{title:"Edit time record",onClose:this.handleClose,isOpen:this.state.isOpen,children:Object(r.jsx)(We,{data:this.state.x,onSubmit:this.handleClose})})]})}}var Zt=g(Me,w)(Gt);var Xt=g(Object(X.withStyles)((e=>({paper:{padding:e.spacing.unit}}))),w)((function(e){const t=e.user.user;return Object(r.jsxs)(le.a,{container:!0,spacing:16,children:[Object(r.jsx)(le.a,{item:!0,xs:12,children:Object(r.jsx)(de.a,{className:e.classes.paper,children:Object(r.jsx)(We,{})})}),Object(r.jsx)(le.a,{item:!0,xs:12,children:Object(r.jsx)(Zt,{filters:[{field:"userId",value:t._id}]})})]})})),$t=a(100),Qt=a.n($t),ea=a(150),ta=a.n(ea),aa=a(36),ra=a.n(aa);var sa=function(e){return Object(r.jsx)(ra.a,Object(o.a)(Object(o.a)({},e),{},{children:Object(r.jsx)("path",{d:"M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z"})}))};var na=e=>e.config?Object(r.jsxs)(Pe.a,{fullWidth:e.fullWidth,color:"primary",tooltip:"Github",onClick:()=>{const t="https://github.com/login/oauth/authorize?client_id=".concat(e.config.id,"&scope=user&redirect_uri=").concat("https://krdeldatlov.sk","?provider=1");window.location.replace(t)},disabled:e.disabled,children:[Object(r.jsx)(sa,{fontSize:"large"})," ",Object(r.jsx)("span",{style:e.fullWidth?{width:200}:null,children:e.title})]}):null;var ia=function(e){return Object(r.jsx)(ra.a,Object(o.a)(Object(o.a)({},e),{},{children:Object(r.jsx)("path",{d:"M21.35,11.1H12.18V13.83H18.69C18.36,17.64 15.19,19.27 12.19,19.27C8.36,19.27 5,16.25 5,12C5,7.9 8.2,4.73 12.2,4.73C15.29,4.73 17.1,6.7 17.1,6.7L19,4.72C19,4.72 16.56,2 12.1,2C6.42,2 2.03,6.8 2.03,12C2.03,17.05 6.16,22 12.25,22C17.6,22 21.5,18.33 21.5,12.91C21.5,11.76 21.35,11.1 21.35,11.1V11.1Z"})}))};var ca=e=>e.config?Object(r.jsxs)(Pe.a,{fullWidth:e.fullWidth,color:"primary",onClick:()=>{const t="https://accounts.google.com/o/oauth2/v2/auth?scope=https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email&redirect_uri=".concat("https://krdeldatlov.sk","?provider=2&response_type=code&client_id=").concat(e.config.id);window.location.replace(t)},disabled:e.disabled,children:[Object(r.jsx)(ia,{fontSize:"large"})," ",Object(r.jsx)("span",{style:e.fullWidth?{width:200}:null,children:e.title})]}):null;var oa=function(e){return Object(r.jsx)(ra.a,Object(o.a)(Object(o.a)({},e),{},{children:Object(r.jsx)("path",{d:"M14.92 17.16l1.83-3.63h2.7l-4.51 8.97l-4.57-8.97h2.7l1.85 3.63m-4.29-8.5l-2.45 4.89H4.55L10.61 1.5l6.13 12.05h-3.63l-2.48-4.89z"})}))};var la=e=>e.config?Object(r.jsxs)(Pe.a,{fullWidth:e.fullWidth,variant:e.variant,color:"primary",onClick:()=>{const t="https://www.strava.com/oauth/authorize?client_id=".concat(e.config.id,"&response_type=code&scope=read,activity:read&redirect_uri=").concat("https://krdeldatlov.sk","?provider=4");window.location.replace(t)},disabled:e.disabled,children:[Object(r.jsx)(oa,{fontSize:"large"})," ",Object(r.jsx)("span",{style:e.fullWidth?{width:200}:null,children:e.title})]}):null;var ua=function(e){return Object(r.jsx)(ra.a,Object(o.a)(Object(o.a)({},e),{},{children:Object(r.jsx)("path",{d:"M12 2.04C6.5 2.04 2 6.53 2 12.06C2 17.06 5.66 21.21 10.44 21.96V14.96H7.9V12.06H10.44V9.85C10.44 7.34 11.93 5.96 14.22 5.96C15.31 5.96 16.45 6.15 16.45 6.15V8.62H15.19C13.95 8.62 13.56 9.39 13.56 10.18V12.06H16.34L15.89 14.96H13.56V21.96A10 10 0 0 0 22 12.06C22 6.53 17.5 2.04 12 2.04Z"})}))};var da=e=>e.config?Object(r.jsxs)(Pe.a,{fullWidth:e.fullWidth,color:"primary",onClick:()=>{const t="https://www.facebook.com/v9.0/dialog/oauth?scope=email,user_link&client_id=".concat(e.config.id,"&redirect_uri=").concat("https://krdeldatlov.sk","/?provider=5&state=1");window.location.replace(t)},disabled:e.disabled,children:[Object(r.jsx)(ua,{fontSize:"large"})," ",Object(r.jsx)("span",{style:e.fullWidth?{width:200}:null,children:e.title})]}):null,pa=a(24);function ha(){return Object(r.jsxs)(V.a,{variant:"body2",color:"textSecondary",align:"center",children:["Copyright \xa9 ",Object(r.jsx)(ta.a,{color:"inherit",href:"https://krdeldatlov.sk",children:"krdeldatlov "})," ",(new Date).getFullYear(),"."]})}class fa extends n.a.Component{constructor(e){var t;super(e),t=this,this.handleSubmit=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r,s,n,i;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),t.setState({disabled:!0}),r=t.state,s=r.username,n=r.password,i=r.token,e.prev=3,e.next=6,t.props.user.auth(s.trim().toLowerCase(),n,i);case 6:null===e.sent&&t.props.user.showMsg("Unauthorized"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),t.props.user.showError(e.t0);case 13:t.setState({disabled:!1});case 14:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}(),this.handleChange=e=>{this.setState({[e.target.name]:e.target.value})},this.handleClickReset=Object(fe.a)(he.a.mark((function e(){var a;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=t.state.username)){e.next=11;break}return e.prev=2,e.next=5,t.props.user.reset(a.trim().toLowerCase());case 5:t.props.user.showMsg("Mail sended."),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),t.props.user.showError(e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])}))),this.state={username:"",password:"",token:"",disabled:!1}}render(){const e=this.props,t=e.classes,a=e.user,s=e.translate,n=this.state,i=n.username,c=n.password,o=n.disabled,l=n.oAuth,u=n.token,p=(this.props.location.state||{from:{pathname:pa.home}}).from;return l?null:a.user?Object(r.jsx)(d.a,{to:p}):Object(r.jsxs)(le.a,{container:!0,component:"main",className:it()(t.root,pa.header?null:t.center),children:[Object(r.jsx)(S.a,{}),pa.header&&Object(r.jsx)(le.a,{item:!0,xs:!1,sm:4,md:7,className:t.image}),Object(r.jsxs)(le.a,{item:!0,xs:12,sm:8,md:5,component:"div",elevation:6,square:!0,className:t.container,children:[Object(r.jsxs)("div",{className:t.paper,children:[Object(r.jsx)(Qt.a,{className:t.avatar,src:pa.logo}),Object(r.jsx)(na,{fullWidth:!0,disabled:o,title:s("githubSignIn"),config:pa.github}),Object(r.jsx)(ca,{fullWidth:!0,disabled:o,title:s("googleSignIn"),config:pa.google}),Object(r.jsx)(da,{fullWidth:!0,disabled:o,title:s("fbSignIn"),config:pa.fb}),Object(r.jsx)(la,{fullWidth:!0,disabled:o,title:s("stravaSignIn"),config:pa.strava}),Object(r.jsx)(V.a,{variant:"body1",children:s("useAccount")}),Object(r.jsxs)("form",{className:t.form,onSubmit:this.handleSubmit,children:[Object(r.jsxs)(je.a,{margin:"normal",required:!0,fullWidth:!0,children:[Object(r.jsx)(ye.a,{htmlFor:"username",children:s("field.username")}),Object(r.jsx)(we.a,{id:"username",name:"username",autoComplete:"username",autoFocus:!0,value:i,onChange:this.handleChange})]}),Object(r.jsxs)(je.a,{margin:"normal",required:!0,fullWidth:!0,children:[Object(r.jsx)(ye.a,{htmlFor:"password",children:s("field.password")}),Object(r.jsx)(we.a,{name:"password",type:"password",id:"password",autoComplete:"current-password",value:c,onChange:this.handleChange})]}),pa["2fa"]&&Object(r.jsxs)(je.a,{margin:"normal",fullWidth:!0,children:[Object(r.jsx)(ye.a,{htmlFor:"password",children:s("field.token")}),Object(r.jsx)(we.a,{name:"token",id:"token",value:u,onChange:this.handleChange})]}),Object(r.jsx)(Pe.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit,disabled:o,children:s("signIn")})]})]}),Object(r.jsx)(ha,{}),Object(r.jsx)("img",{className:t.footer,width:"100%",alt:"websupport",src:"/img/ws.jpg",onClick:()=>window.open("https://www.websupport.sk/?ref=NTksG1s7","_blank")})]})]})}}var ba=g(v()((e=>({root:{height:"100vh"},container:{display:"flex",flexDirection:"column",minHeight:"100vh"},footer:{marginTop:"auto"},image:{backgroundImage:"url(".concat(pa.header,")"),backgroundRepeat:"no-repeat",backgroundColor:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"},paper:{margin:8*e.spacing.unit,marginBottom:4*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing.unit,width:128,height:128},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:3*e.spacing.unit,marginBottom:e.spacing.unit},center:{display:"flex",alignItems:"center",flexDirection:"column"}}))),w,Me,se)(fa);const xa={name:"",collaborators:[],key:0};class ma extends n.a.Component{constructor(...e){var t;super(...e),t=this,this.state=this.props.data||xa,this.handleChange=(e,t)=>{this.setState({[e]:t})},this.handleSubmit=Object(fe.a)(he.a.mark((function e(){var a,r,s,n,i;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.store,r=a.addProject,s=a.getProjects,n=a.editProject,i=t.props.user.user,e.prev=2,!t.state._id){e.next=8;break}return e.next=6,n(t.state,i);case 6:e.next=10;break;case 8:return e.next=10,r(t.state,i);case 10:s(),t.setState(xa),t.props.onSubmit&&t.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),t.props.user.showError(e.t0);case 18:case"end":return e.stop()}}),e,null,[[2,15]])})))}componentDidMount(){var e=this;return Object(fe.a)(he.a.mark((function t(){var a,r,s;return he.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.user.getUsers,r=e.props.user.user,s=[{field:"_id",op:"ne",value:r._id}],t.prev=3,t.next=6,a(s);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3),e.props.user.showError(t.t0);case 11:case"end":return t.stop()}}),t,null,[[3,8]])})))()}render(){const e=this.props.classes,t=this.state,a=t.name,s=t.collaborators,n=t.key,i=this.props.user.users;return Object(r.jsxs)(Le,{onSubmit:this.handleSubmit,inline:!0,children:[Object(r.jsx)(Ce,{value:a,field:"name",onChange:this.handleChange,required:!0}),Object(r.jsx)("div",{className:e.collaborators,children:Object(r.jsx)(Ee,{value:s,field:"collaborators",onChange:this.handleChange,data:i.data,textField:"name",fullWidth:!0,multiple:!0})}),Object(r.jsx)(Se,{value:n,field:"key",onChange:this.handleChange,min:0,step:1,required:!0})]})}}var ja=g(Object(X.withStyles)((e=>({collaborators:{display:"flex",flex:1}}))),Me,w)(ma),va=a(311),ga=a.n(va);class Oa extends n.a.Component{constructor(...e){var t;super(...e),t=this,this.onDelete=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r,s,n;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props,s=r.onDelete,n=r.onChange,e.next=3,s(a);case 3:n();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}componentDidMount(){this.props.onChange()}render(){const e=this.props,t=e.data,a=e.onClick,s=e.primaryTextField,n=e.secondaryTextField,i=e.onEdit,c=e.isDisabled,o=e.classes;return Object(r.jsxs)(de.a,{className:o.listWrapper,children:[Object(r.jsx)(Ut,{isLoading:t.isLoading}),Object(r.jsx)(F.a,{children:t.data.map((e=>Object(r.jsxs)(R.a,{button:!0,onClick:()=>a(e._id),children:[Object(r.jsx)(A.a,{primary:zt.a.get(e,s),secondary:n?zt.a.get(e,n):null}),Object(r.jsx)(ga.a,{children:Object(r.jsx)(Rt,{disabled:c(e),onEdit:()=>i(e),onDelete:()=>this.onDelete(e._id)})})]},e._id)))})]})}}var wa=Object(X.withStyles)((e=>({listWrapper:{position:"relative"}})))(Oa);class ka extends n.a.Component{constructor(...e){var t;super(...e),t=this,this.state={x:null,isOpen:!1},this.handleClose=()=>{this.setState({isOpen:!1})},this.handleOpen=()=>{this.setState({isOpen:!0})},this.handleClick=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.props.history.location.pathname+"/"+a,t.props.history.push(r);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleChange=e=>{try{this.props.store.getProjects(this.props.user.user)}catch(t){this.props.user.showError(t)}},this.handleEdit=e=>{this.setState({x:e,isOpen:!0})},this.handleDelete=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props.store.deleteProject,e.prev=1,e.next=4,r(a);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),t.props.user.showError(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),this.isDisabled=e=>this.props.user.user._id!==e.userId}render(){const e=this.props.classes,t=this.props.store.projects;return Object(r.jsxs)("div",{className:e.list,children:[Object(r.jsx)(wa,{data:t,primaryTextField:"name",onClick:this.handleClick,onChange:this.handleChange,onEdit:this.handleEdit,onDelete:this.handleDelete,isDisabled:this.isDisabled}),Object(r.jsx)(Kt,{title:"Edit project",onClose:this.handleClose,isOpen:this.state.isOpen,children:Object(r.jsx)(ja,{data:this.state.x,onSubmit:this.handleClose})})]})}}var ya=g(Object(X.withStyles)((e=>({list:{marginTop:e.spacing.unit}}))),Me,w,d.f)(ka);var Ca=Object(X.withStyles)((e=>({paper:{padding:e.spacing.unit}})))((function(e){return Object(r.jsx)(le.a,{container:!0,spacing:24,children:Object(r.jsxs)(le.a,{item:!0,xs:12,children:[Object(r.jsx)(de.a,{className:e.classes.paper,children:Object(r.jsx)(ja,{})}),Object(r.jsx)(ya,{})]})})}));const Sa={name:"",assignedToId:null,stateId:null,typeId:null};class Ta extends n.a.Component{constructor(...e){var t;super(...e),t=this,this.state=this.props.data||Sa,this.handleChange=(e,t)=>{this.setState({[e]:t})},this.handleSubmit=Object(fe.a)(he.a.mark((function e(){var a,r,s,n,i;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.store,r=a.addTask,s=a.refreshTasks,n=a.editTask,i=t.props.user.user,e.prev=2,!t.state._id){e.next=8;break}return e.next=6,n(t.state);case 6:e.next=10;break;case 8:return e.next=10,r(t.state,i,t.props.projectId);case 10:s(),t.setState(Sa),t.props.onSubmit&&t.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),t.props.user.showError(e.t0);case 18:case"end":return e.stop()}}),e,null,[[2,15]])})))}render(){const e=this.props.classes,t=this.props.store.enums,a=this.state,s=a.name,n=a.assignedToId,i=a.stateId,c=a.typeId,o=this.props.store.users;return Object(r.jsxs)(Le,{onSubmit:this.handleSubmit,inline:!0,children:[Object(r.jsx)("div",{className:e.name,children:Object(r.jsx)(Ce,{value:s,field:"name",onChange:this.handleChange,required:!0,fullWidth:!0})}),Object(r.jsx)(Ee,{value:n,field:"assignedToId",onChange:this.handleChange,data:o.data,textField:"name"}),Object(r.jsx)(Ee,{value:i,field:"stateId",onChange:this.handleChange,data:t.data.filter((e=>3===e.enumTypeId)),required:!0,textField:"name"}),Object(r.jsx)(Ee,{value:c,field:"typeId",onChange:this.handleChange,data:t.data.filter((e=>4===e.enumTypeId)),textField:"name"})]})}}var Da=g(Object(X.withStyles)((e=>({name:{display:"flex",flex:1}}))),Me,w)(Ta);const Ia=[{field:"name",disablePadding:!0},{field:"_assignedTo.name",type:"enum",data:"users",idField:"assignedToId",sortable:!1},{field:"_state.name",type:"enum",data:"enums",idField:"stateId",sortable:!1,getData:e=>e.filter((e=>3===e.enumTypeId))},{field:"_type.name",type:"enum",data:"enums",idField:"typeId",sortable:!1,getData:e=>e.filter((e=>4===e.enumTypeId))}],_a=[];class Ea extends n.a.Component{constructor(...e){var t;super(...e),t=this,this.state={x:null,isOpen:!1},this.handleClose=()=>{this.setState({isOpen:!1})},this.handleOpen=()=>{this.setState({isOpen:!0})},this.handleChange=function(){var e=Object(fe.a)(he.a.mark((function e(a,r,s,n){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.props.store.getTasks(t.props.projectId,a,r,s,n);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),t.props.user.showError(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a,r,s){return e.apply(this,arguments)}}(),this.onEdit=e=>{this.setState({x:e,isOpen:!0})},this.isDisabled=e=>this.props.user.user._id!==e.userId&&this.props.user.user._id!==e.assignedToId}render(){const e=this.props.store,t=e.deleteTask,a=e.project,s=a?"".concat(a.name,"_tasks"):null;return Object(r.jsxs)("div",{children:[Object(r.jsx)(Jt,{rows:Ia,data:"tasks",onChange:this.handleChange,onDelete:t,title:"Tasks",onEdit:this.onEdit,store:this.props.store,filters:_a,isDisabled:this.isDisabled,filename:s}),Object(r.jsx)(Kt,{title:"Edit task",onClose:this.handleClose,isOpen:this.state.isOpen,children:Object(r.jsx)(Da,{data:this.state.x,onSubmit:this.handleClose})})]})}}var Na=g(Me,w)(Ea);class Pa extends n.a.Component{componentDidMount(){var e=this;return Object(fe.a)(he.a.mark((function t(){return he.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.props.store.getProject(e.props.match.params.id);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),e.props.user.showError(t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()}render(){return Object(r.jsxs)(le.a,{container:!0,spacing:24,children:[Object(r.jsx)(le.a,{item:!0,xs:12,children:Object(r.jsx)(de.a,{className:this.props.classes.paper,children:Object(r.jsx)(Da,{projectId:this.props.match.params.id})})}),Object(r.jsx)(le.a,{item:!0,xs:12,children:Object(r.jsx)(Na,{projectId:this.props.match.params.id})})]})}}var Fa=g(Object(X.withStyles)((e=>({paper:{padding:e.spacing.unit}}))),Me)(Pa);var La=Object(X.withStyles)((e=>({formControl:{margin:e.spacing.unit,width:160}})))((function(e){return Object(r.jsxs)(jt.a,{onClose:e.onClose,"aria-labelledby":"simple-dialog-title",open:e.isOpen,fullWidth:!0,children:[Object(r.jsx)(St.a,{id:"simple-dialog-title",children:e.title}),e.children,Object(r.jsxs)(gt.a,{children:[e.onCancel&&Object(r.jsx)(Pe.a,{onClick:e.onCancel,color:"primary",children:"Cancel"}),e.onConfirm&&Object(r.jsx)(Pe.a,{onClick:e.onConfirm,color:"primary",autoFocus:!0,children:"OK"})]})]})}));class Ra extends n.a.Component{render(){const e=this.props,t=e.value,a=e.defaultValue,s=e.tooltip,n=e.onClick,i=e.className,c=e.placement;return Object(r.jsx)(at.a,{title:s,"aria-label":s,placement:c,children:Object(r.jsx)(Qt.a,{style:{textTransform:"uppercase"},alt:a,src:t?"data:image/jpeg;base64,"+t:null,onClick:n,className:i,children:s[0]})})}}var Ma=Object(X.withStyles)((e=>({})))(Ra);const Aa=e=>({col:{display:"flex",flex:1,flexDirection:"column",marginBottom:e.spacing.unit},row:{display:"flex",flexWrap:"wrap",flexDirection:"row"},center:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},paper:{padding:e.spacing.unit},flex:{display:"flex"},grow:{display:"flex",flex:1}});var Ua=e=>t=>{const a=Object(s.useRef)(null),n=function(){var e=Object(fe.a)(he.a.mark((function e(t,a,r){var s,n;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(s=new FormData).append("file",a),e.next=4,fetch("".concat(t,"/api/file"),{method:"POST",headers:{Authorization:"Basic "+r},body:s});case 4:if(200!==(n=e.sent).status){e.next=11;break}return e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 11:return e.t0=console,e.next=14,n.text();case 14:throw e.t1=e.sent,e.t0.log.call(e.t0,e.t1),new Error(n.statusText);case 17:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}();return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(e,Object(o.a)(Object(o.a)({},t),{},{utils:{resize:(e,t,r=null)=>new Promise((s=>{const n=new Image,i=a.current;n.onload=()=>{n.height>t&&(n.width*=t/n.height,n.height=t);const e=i.getContext("2d");e.clearRect(0,0,i.width,i.height),i.width=n.width,i.height=n.height,e.drawImage(n,0,0,n.width,n.height),r?i.toBlob((e=>{e.name=r,s(e)}),"image/jpeg"):s(i.toDataURL("image/jpeg"))},n.src=e})),postFile:n}})),Object(r.jsx)("canvas",{style:{display:"none"},ref:a})]})};class Wa extends n.a.Component{constructor(e){var t;super(e),t=this,this.onChange=e=>{e.preventDefault();const a=new FileReader;a.onloadend=Object(fe.a)(he.a.mark((function e(){var r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.props.utils.resize(a.result,320);case 2:r=(r=e.sent).split(",").pop(),t.props.onChange(t.props.field,r);case 5:case"end":return e.stop()}}),e)}))),a.readAsDataURL(e.target.files[0])},this.onClick=()=>{this.props.disabled||this.inputRef.current.click()},this.inputRef=n.a.createRef()}render(){const e=this.props,t=e.classes,a=e.value,s=e.tooltip,n=e.disabled;return Object(r.jsxs)("div",{className:t.center,style:{cursor:n?"default":"pointer"},children:[Object(r.jsx)(Ma,{className:t.bigAvatar,value:a,onClick:this.onClick,tooltip:s,placement:"right"}),Object(r.jsx)("input",{ref:this.inputRef,style:{display:"none"},type:"file",accept:"image/jpeg",onChange:this.onChange})]})}}var qa=Ua(Object(X.withStyles)((e=>Object(o.a)(Object(o.a)({},Aa(e)),{},{bigAvatar:{margin:e.spacing.unit,width:80,height:80}})))(Wa)),za=a(312),Ba=a.n(za),Va=a(313),Ja=a.n(Va);var Ka=Object(X.withStyles)((e=>({formControl:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit}})))((function(e){const t=e.classes;return Object(r.jsx)(Ba.a,{className:t.formControl,control:Object(r.jsx)(Ja.a,{checked:e.value,onChange:t=>e.onChange(e.field,t.target.checked),value:e.field,disabled:e.disabled}),label:e.label})}));const Ha={password:{value:"",errorText:""},repeatedPassword:{value:"",errorText:""},email:{value:"",isLoading:!1,errorText:""},name:"",username:{value:"",isLoading:!1,errorText:""},tel:"",address:"",city:"",postCode:"",country:"",otp:!1,avatar:null},Ya=e=>Object(o.a)(Object(o.a)(Object(o.a)({},Ha),e),{},{email:Object(o.a)(Object(o.a)({},Ha.email),{},{value:e.email}),username:Object(o.a)(Object(o.a)({},Ha.username),{},{value:e.username}),isOpenSecretDialog:!1,avatarChanged:!1});class Ga extends n.a.Component{constructor(...e){var t;super(...e),t=this,this.state=Ya(this.props.user.user),this.handleChange=(e,t)=>{this.setState((a=>zt.a.set(a,e,t)))},this.validPasswords=()=>{const e=this.state,t=e.password,a=e.repeatedPassword,r=this.props.translate,s=new RegExp(pa.passwordPattern),n=!t.value||s.test(t.value),i=n?"":r("field.passwordWeak"),c=t.value===a.value,l=c?"":r("field.passwordNoMatch");return this.setState((e=>({password:Object(o.a)(Object(o.a)({},e.password),{},{errorText:i}),repeatedPassword:Object(o.a)(Object(o.a)({},this.state.repeatedPassword),{},{errorText:l})}))),n&&c},this.validEmail=Object(fe.a)(he.a.mark((function e(){var a,r,s,n;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.translate,r=t.state.email,t.setState((e=>({email:Object(o.a)(Object(o.a)({},e.email),{},{isLoading:!0})}))),e.t0=!r.value,e.t0){e.next=8;break}return e.next=7,t.isValid(r.value);case 7:e.t0=e.sent;case 8:return s=e.t0,n=s?"":a("field.emailInUse"),t.setState((e=>({email:Object(o.a)(Object(o.a)({},e.email),{},{errorText:n,isLoading:!1})}))),e.abrupt("return",s);case 12:case"end":return e.stop()}}),e)}))),this.isValid=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r,s;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props.user,e.next=3,t.props.user.checkUser(a);case 3:return s=e.sent,e.abrupt("return",0===s.length||1===s.length&&s[0]._id===r.user._id);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.validUsername=Object(fe.a)(he.a.mark((function e(){var a,r,s,n;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.translate,r=t.state.username,t.setState((e=>({username:Object(o.a)(Object(o.a)({},e.username),{},{isLoading:!0})}))),e.t0=!r.value,e.t0){e.next=8;break}return e.next=7,t.isValid(r.value);case 7:e.t0=e.sent;case 8:return s=e.t0,n=s?"":a("field.usernameInUse"),t.setState((e=>({username:Object(o.a)(Object(o.a)({},e.username),{},{errorText:n,isLoading:!1})}))),e.abrupt("return",s);case 12:case"end":return e.stop()}}),e)}))),this.handleChangeAvatar=(e,t)=>{this.setState({[e]:t,avatarChanged:!0})},this.generateSecret=Object(fe.a)(he.a.mark((function e(){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.props.user.generateSecret();case 3:t.handleOpenSecretDialog(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),t.props.user.showError(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),this.handleOpenSecretDialog=()=>{this.setState({isOpenSecretDialog:!0})},this.handleCloseSecretDialog=()=>{this.setState({isOpenSecretDialog:!1})},this.handleSubmit=Object(fe.a)(he.a.mark((function e(){var a,r,s,n,i,c,o,l,u,d,p,h,f;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.state,r=a.password,s=a.name,n=a.username,i=a.email,c=a.tel,o=a.address,l=a.city,u=a.postCode,d=a.country,p=a.otp,h=a.avatar,f=a.avatarChanged,e.t1=t.validPasswords(),!e.t1){e.next=6;break}return e.next=5,t.validEmail();case 5:e.t1=e.sent;case 6:if(e.t0=e.t1,!e.t0){e.next=11;break}return e.next=10,t.validUsername();case 10:e.t0=e.sent;case 11:if(e.t0){e.next=14;break}return e.abrupt("return");case 14:return e.prev=14,e.next=17,t.props.user.updateUser(t.state._id,{email:i.value,password:r.value,name:s,username:n.value,tel:c,address:o,city:l,postCode:u,country:d,otp:p,avatar:f?h:null});case 17:t.setState(Ya(t.props.user.user)),t.props.user.showMsg("Ok."),e.next=24;break;case 21:e.prev=21,e.t2=e.catch(14),t.props.user.showError(e.t2);case 24:case"end":return e.stop()}}),e,null,[[14,21]])})))}render(){const e=this.props,t=e.classes,a=e.disabled,s=this.state,n=s.password,i=s.repeatedPassword,c=s.username,o=s.name,l=s.email,u=s.tel,d=s.otp,p=s.avatar,h=s.address,f=s.city,b=s.postCode,x=s.country;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(Le,{onSubmit:this.handleSubmit,disabled:a,children:[Object(r.jsx)(qa,{field:"avatar",onChange:this.handleChangeAvatar,value:p,disabled:a,tooltip:o||""}),Object(r.jsx)(Ce,{value:o,field:"name",onChange:this.handleChange,required:!0,disabled:a}),Object(r.jsxs)("div",{className:t.row,children:[Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{type:"email",value:l.value,field:"email.value",onChange:this.handleChange,disabled:a||l.isLoading,onBlur:this.validEmail,errorText:l.errorText,required:!0})}),Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{value:u,field:"tel",onChange:this.handleChange,disabled:a})})]}),Object(r.jsx)(Ce,{value:c.value,field:"username.value",onChange:this.handleChange,required:!0,disabled:a||c.isLoading,onBlur:this.validUsername,errorText:c.errorText}),Object(r.jsxs)("div",{className:t.row,children:[Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{value:n.value,field:"password.value",type:"new-password",onChange:this.handleChange,disabled:a,onBlur:this.validPasswords,errorText:n.errorText})}),Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{value:i.value,field:"repeatedPassword.value",type:"password",onChange:this.handleChange,disabled:a,onBlur:this.validPasswords,errorText:i.errorText})})]}),Object(r.jsxs)("div",{className:t.row,children:[Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{value:h,field:"address",type:"address",onChange:this.handleChange,disabled:a})}),Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{value:b,field:"postCode",type:"postCode",onChange:this.handleChange,disabled:a})})]}),Object(r.jsxs)("div",{className:t.row,children:[Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{value:f,field:"city",type:"city",onChange:this.handleChange,disabled:a})}),Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{value:x,field:"country",type:"country",onChange:this.handleChange,disabled:a})})]}),pa["2fa"]&&Object(r.jsx)("div",{className:t.row,children:Object(r.jsx)("div",{className:t.col,children:Object(r.jsxs)("div",{children:[Object(r.jsx)(Ka,{value:d,field:"otp",onChange:this.handleChange,disabled:a}),Object(r.jsx)(Pe.a,{color:"primary",disabled:a||!this.state.otp,onClick:this.generateSecret,children:this.props.translate("generateSecret")})]})})})]}),Object(r.jsx)(La,{title:this.props.translate("secret"),isOpen:this.state.isOpenSecretDialog,onConfirm:this.handleCloseSecretDialog,children:Object(r.jsx)("div",{className:t.center,children:this.props.user.secret&&Object(r.jsx)("img",{src:"data:image/jpeg;base64,"+this.props.user.secret.qrCode,alt:"secret",width:320,height:320})})})]})}}var Za=g(Object(X.withStyles)((e=>Object(o.a)(Object(o.a)({},Aa(e)),{},{heading:{marginLeft:e.spacing.unit},detailHeading:{marginLeft:e.spacing.unit,marginTop:3*e.spacing.unit},actions:{float:"right",margin:e.spacing.unit}}))),Me,w,se)(Ga);var Xa={user:1,store:2,mail:4,file:8,report:16,tags:1024,tasks:2048,events:4096,enums:2,activities:pa.strava?2:16};var $a=g(Object(X.withStyles)((e=>({paper:{padding:e.spacing.unit},heading:{marginLeft:e.spacing.unit},connected:{padding:e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"flex-start"}}))),w,se)((function(e){const t=e.user,a=t.user,s=!(0,t.hasPermission)(Xa.user),n=e.translate("connect");return Object(r.jsxs)(le.a,{container:!0,spacing:16,children:[Object(r.jsx)(le.a,{item:!0,xs:12,sm:8,children:Object(r.jsx)(de.a,{className:e.classes.paper,children:Object(r.jsx)(Za,{disabled:s})})}),Object(r.jsx)(le.a,{item:!0,xs:12,sm:4,children:Object(r.jsxs)(de.a,{className:e.classes.connected,children:[Object(r.jsx)(V.a,{variant:"h6",className:e.classes.heading,children:e.translate("connected")}),Object(r.jsx)(na,{config:pa.github,disabled:s||a.github,title:e.user.user.github?e.user.user.github.name:n}),Object(r.jsx)(ca,{config:pa.google,disabled:s||a.google,title:e.user.user.google?e.user.user.google.name:n}),Object(r.jsx)(da,{config:pa.fb,disabled:s||a.fb,title:e.user.user.fb?e.user.user.fb.name:n}),Object(r.jsxs)("div",{children:[Object(r.jsx)(la,{config:pa.strava,disabled:s,title:e.user.user.strava?e.translate("sync"):n}),pa.strava&&e.user.user.strava&&e.user.user.strava.synced&&Object(r.jsxs)("span",{children:[" (",e.translate("lastSync")," ",new Date(e.user.user.strava.synced).toLocaleDateString(e.locale),") "]})]})]})})]})})),Qa=a(48);class er extends s.PureComponent{render(){const e=this.props.store.dateStats,t=this.props.theme;return Object(r.jsx)(de.a,{className:this.props.classes.paper,children:Object(r.jsxs)(Qa.b,{width:800,height:300,data:e.data,children:[Object(r.jsx)(Qa.c,{strokeDasharray:"3 3"}),Object(r.jsx)(Qa.g,{dataKey:"name"}),Object(r.jsx)(Qa.h,{}),Object(r.jsx)(Qa.f,{}),Object(r.jsx)(Qa.a,{dataKey:"duration",fill:t.palette.primary.main})]})})}}var tr=g(Me,Object(X.withStyles)((e=>({paper:{width:"100%",padding:e.spacing.unit,overflowX:"auto",margin:"auto"}}))),Object(X.withTheme)())(er);class ar extends s.PureComponent{render(){const e=this.props.store,t=e.projectStats,a=e.userStats,s=this.props.theme;return Object(r.jsx)(de.a,{className:this.props.classes.paper,children:Object(r.jsxs)(Qa.e,{width:300,height:300,children:[Object(r.jsx)(Qa.d,{dataKey:"val",data:t.data,cx:150,cy:150,innerRadius:80,outerRadius:100,fill:s.palette.secondary.main,label:!0}),Object(r.jsx)(Qa.d,{dataKey:"val",isAnimationActive:!1,data:a.data,cx:150,cy:150,outerRadius:70,fill:s.palette.primary.main}),Object(r.jsx)(Qa.f,{})]})})}}var rr=g(Me,Object(X.withStyles)((e=>({paper:{padding:e.spacing.unit,display:"flex",justifyContent:"center"}}))),Object(X.withTheme)())(ar);var sr=Object(X.withStyles)((e=>({paper:{padding:e.spacing.unit}})))((function(e){return Object(r.jsxs)(le.a,{container:!0,spacing:16,children:[Object(r.jsx)(le.a,{item:!0,xs:12,md:4,className:e.classes.center,children:Object(r.jsx)(rr,{})}),Object(r.jsx)(le.a,{item:!0,xs:12,md:8,children:Object(r.jsx)(tr,{})}),Object(r.jsx)(le.a,{item:!0,xs:12,children:Object(r.jsx)(Zt,{filters:[],defaultFilters:{period:4}})})]})}));let nr,ir,cr;class or extends n.a.Component{constructor(e){super(e);const t=new URLSearchParams(this.props.location.search);ir=t.get("provider"),nr=t.get("code")}componentDidMount(){var e=this;return Object(fe.a)(he.a.mark((function t(){var a;return he.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!ir||cr){t.next=22;break}if(cr=!0,a=e.props.user,t.prev=3,!a.user){t.next=10;break}return t.next=7,a.updateOauth(ir,nr);case 7:e.props.history.replace("/account"),t.next=15;break;case 10:return t.next=12,a.oAuth(ir,nr);case 12:if(t.sent){t.next=14;break}a.showMsg("Unauthorized");case 14:e.props.history.replace(pa.home);case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(3),e.props.user.showError(t.t0),e.props.history.replace("/login");case 21:cr=!1;case 22:case"end":return t.stop()}}),t,null,[[3,17]])})))()}render(){const e=this.props,t=e.classes,a=e.translate;return ir?Object(r.jsxs)("main",{className:t.main,children:[Object(r.jsx)(S.a,{}),Object(r.jsxs)(de.a,{className:t.paper,children:[Object(r.jsx)(Qt.a,{className:t.avatar,src:pa.logo}),Object(r.jsx)("div",{className:t.loader,children:Object(r.jsx)(V.a,{component:"h1",variant:"h5",children:a("loading")})})]})]}):Object(r.jsx)(d.a,{to:{pathname:pa.home}})}}var lr=g(v()((e=>({main:{width:"100%",display:"block",marginLeft:3*e.spacing.unit,marginRight:3*e.spacing.unit,[e.breakpoints.up(400+3*e.spacing.unit*2)]:{width:400,marginLeft:"auto",marginRight:"auto"}},paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px")},avatar:{margin:e.spacing.unit,width:128,height:128},loader:{marginTop:e.spacing.unit}}))),w,Me,se)(or);const ur={name:"",address:"",ico:"",dic:"",icdph:"",rate:0,reportId:"",activity:""};class dr extends n.a.Component{constructor(...e){var t;super(...e),t=this,this.state=this.props.data||ur,this.handleChange=(e,t)=>{this.setState({[e]:t})},this.handleSubmit=Object(fe.a)(he.a.mark((function e(){var a,r,s,n,i;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.store,r=a.addClient,s=a.getClients,n=a.editClient,i=t.props.user.user,e.prev=2,!t.state._id){e.next=8;break}return e.next=6,n(t.state,i);case 6:e.next=10;break;case 8:return e.next=10,r(t.state,i);case 10:s(),t.props.onSubmit&&t.props.onSubmit(),t.setState(ur),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),t.props.user.showError(e.t0);case 18:case"end":return e.stop()}}),e,null,[[2,15]])})))}render(){const e=this.props,t=e.classes,a=e.disabled,s=this.state,n=s.name,i=s.address,c=s.ico,o=s.dic,l=s.icdph,u=s.rate,d=s.reportId,p=s.activity;return Object(r.jsxs)(Le,{onSubmit:this.handleSubmit,disabled:a,children:[Object(r.jsx)("div",{className:t.row,children:Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{label:"Name",value:n,field:"name",onChange:this.handleChange,required:!0,disabled:a})})}),Object(r.jsx)("div",{className:t.row,children:Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{className:t.col,label:"Address",value:i,field:"address",onChange:this.handleChange,required:!0,disabled:a})})}),Object(r.jsxs)("div",{className:t.row,children:[Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{label:"I\u010cO",value:c,field:"ico",onChange:this.handleChange,required:!0,disabled:a})}),Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{className:t.col,label:"DI\u010c",value:o,field:"dic",onChange:this.handleChange,required:!0,disabled:a})}),Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{className:t.col,label:"I\u010c DPH",value:l,field:"icdph",onChange:this.handleChange,required:!0,disabled:a})})]}),Object(r.jsxs)("div",{className:t.row,children:[Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{label:"Activity",value:p,field:"activity",onChange:this.handleChange,required:!0,disabled:a})}),Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Se,{label:"Rate",value:u,field:"rate",onChange:this.handleChange,min:0,step:.5,required:!0})}),Object(r.jsx)("div",{className:t.col,children:Object(r.jsx)(Ce,{className:t.col,label:"ReportId",value:d,field:"reportId",onChange:this.handleChange,required:!0,disabled:a})})]})]})}}var pr=g(Object(X.withStyles)((e=>Object(o.a)({},Aa(e)))),Me,w)(dr);class hr extends n.a.Component{constructor(...e){var t;super(...e),t=this,this.state={x:null,isOpen:!1},this.handleClose=()=>{this.setState({isOpen:!1})},this.handleOpen=()=>{this.setState({isOpen:!0})},this.handleClick=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.props.history.location.pathname+"/"+a,t.props.history.push(r);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleChange=e=>{try{this.props.store.getClients()}catch(t){this.props.user.showError(t)}},this.handleEdit=e=>{this.setState({x:e,isOpen:!0})},this.handleDelete=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props.store.deleteClient,e.prev=1,e.next=4,r(a);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),t.props.user.showError(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),this.isDisabled=e=>this.props.user.user._id!==e.userId}render(){const e=this.props.classes,t=this.props.store.clients;return Object(r.jsxs)("div",{className:e.list,children:[Object(r.jsx)(wa,{data:t,primaryTextField:"name",onClick:this.handleClick,onChange:this.handleChange,onEdit:this.handleEdit,onDelete:this.handleDelete,isDisabled:this.isDisabled}),Object(r.jsx)(Kt,{title:"Edit client",onClose:this.handleClose,isOpen:this.state.isOpen,children:Object(r.jsx)(pr,{data:this.state.x,onSubmit:this.handleClose})})]})}}var fr=g(Object(X.withStyles)((e=>({list:{marginTop:e.spacing.unit}}))),Me,w,d.f)(hr);var br=Object(X.withStyles)((e=>({paper:{padding:e.spacing.unit}})))((function(e){return Object(r.jsx)(le.a,{container:!0,spacing:24,children:Object(r.jsxs)(le.a,{item:!0,xs:12,children:[Object(r.jsx)(de.a,{className:e.classes.paper,children:Object(r.jsx)(pr,{})}),Object(r.jsx)(fr,{})]})})}));var xr=Object(X.withStyles)((e=>({formControl:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit,minWidth:160}})))((function(e){const t=e.classes;return Object(r.jsx)(be.b,{className:t.formControl,keyboard:!0,ampm:!1,label:e.label,format:"MM/DD/YYYY HH:mm",clearable:!e.required,mask:e=>e?[/\d/,/\d/,"/",/\d/,/\d/,"/",/\d/,/\d/,/\d/,/\d/," ",/\d/,/\d/,":",/\d/,/\d/]:[],value:e.value||null,onChange:t=>e.onChange(e.field,t?t.toDate():null),disableOpenOnEnter:!0,animateYearScrolling:!1,style:{flex:1,display:"flex"},disabled:e.disabled})}));class mr extends n.a.Component{constructor(e){var t;super(e),t=this,this.getInitState=e=>{const t=e.date||It()().add(1,"days").toDate();return{start:t,end:t,name:"",eventTypeId:null}},this.handleChange=(e,t)=>{this.setState({[e]:t})},this.handleChangeStart=(e,t)=>{t.getTime()>this.state.end.getTime()?this.setState({start:t,end:t}):this.setState({start:t})},this.handleChangeEnd=(e,t)=>{t.getTime()<this.state.start.getTime()?this.setState({start:t,end:t}):this.setState({end:t})},this.handleSubmit=Object(fe.a)(he.a.mark((function e(){var a,r,s,n,i;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.store,r=a.addEvent,s=a.refreshEvents,n=a.editEvent,i=t.props.user.user,e.prev=2,!t.state._id){e.next=8;break}return e.next=6,n(t.state,i);case 6:e.next=10;break;case 8:return e.next=10,r(t.state,i);case 10:s(),t.setState(t.getInitState(t.props)),t.props.onSubmit&&t.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),t.props.user.showError(e.t0);case 18:case"end":return e.stop()}}),e,null,[[2,15]])}))),this.state=e.data||this.getInitState(e)}render(){const e=this.props,t=e.classes,a=e.disabled,s=this.state,n=s.name,i=s.eventTypeId,c=s.start,o=s.end,l=this.props.store.enums;return Object(r.jsxs)(Le,{onSubmit:this.handleSubmit,inline:!0,disabled:a,children:[Object(r.jsx)("div",{className:t.nameTextInput,children:Object(r.jsx)(Ce,{label:"Name",value:n,field:"name",onChange:this.handleChange,fullWidth:!0,required:!0,disabled:a})}),Object(r.jsx)(Ee,{label:"Type",value:i,field:"eventTypeId",onChange:this.handleChange,data:l.data,textField:"name",disabled:a}),Object(r.jsxs)("div",{className:t.nameTextInput,children:[Object(r.jsx)(xr,{label:"Start",value:c,field:"start",onChange:this.handleChangeStart,required:!0,disabled:a}),Object(r.jsx)(xr,{label:"End",value:o,field:"end",onChange:this.handleChangeEnd,required:!0,disabled:a})]})]})}}var jr=g(Object(X.withStyles)((e=>({nameTextInput:{display:"flex",flex:1}}))),Me,w)(mr);const vr=[{field:"name",disablePadding:!0,label:"Name"},{field:"_eventType.name",label:"Type",type:"enum",data:"enums",idField:"eventTypeId"},{field:"start",type:"datetime",label:"Start",filterable:!1},{field:"end",type:"datetime",label:"End",filterable:!1},{field:"_user.name",label:"User",type:"enum",data:"users",idField:"userId"}],gr=[{label:"Period",field:"period",data:[{_id:1,name:"today",filters:[{field:"start",op:"lte",value:It()().endOf("day").toDate()},{field:"start",op:"gte",value:It()().startOf("day").toDate()}]},{_id:2,name:"this week",filters:[{field:"start",op:"lte",value:It()().endOf("week").toDate()},{field:"start",op:"gte",value:It()().startOf("week").toDate()}]},{_id:3,name:"last week",filters:[{field:"start",op:"lte",value:It()().subtract(1,"weeks").endOf("week").toDate()},{field:"start",op:"gte",value:It()().subtract(1,"weeks").startOf("week").toDate()}]},{_id:4,name:"this month",filters:[{field:"start",op:"lte",value:It()().endOf("month").toDate()},{field:"start",op:"gte",value:It()().startOf("month").toDate()}]},{_id:5,name:"last month",filters:[{field:"start",op:"lte",value:It()().subtract(1,"month").endOf("month").toDate()},{field:"start",op:"gte",value:It()().subtract(1,"month").startOf("month").toDate()}]}]}];class Or extends n.a.Component{constructor(e){var t;super(e),t=this,this.handleChangeClient=(e,t)=>{this.setState({clientId:t})},this.handleClose=()=>{this.setState({isOpen:!1})},this.handleOpen=()=>{this.setState({isOpen:!0})},this.handleChange=function(){var e=Object(fe.a)(he.a.mark((function e(a,r){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.props.store.getEvents(a,r);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),t.props.user.showError(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}(),this.onEdit=function(){var e=Object(fe.a)(he.a.mark((function e(a){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.setState({x:a,isOpen:!0});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.isDisabled=e=>this.props.user.user._id!==e.userId,this.state={x:null,isOpen:!1}}render(){const e=this.props.store.deleteEvent;return Object(r.jsxs)("div",{children:[Object(r.jsx)(Jt,{rows:vr,data:"events",onChange:this.handleChange,sortable:!1,onDelete:e,title:"Events",onEdit:this.onEdit,store:this.props.store,filters:gr,isDisabled:this.isDisabled}),Object(r.jsx)(Kt,{title:"Edit event",onClose:this.handleClose,isOpen:this.state.isOpen,children:Object(r.jsx)(jr,{data:this.state.x,onSubmit:this.handleClose})})]})}}var wr=g(Me,w)(Or);var kr=g(Object(X.withStyles)((e=>({paper:{padding:e.spacing.unit}}))),w)((function(e){return Object(r.jsxs)(le.a,{container:!0,spacing:16,children:[Object(r.jsx)(le.a,{item:!0,xs:12,children:Object(r.jsx)(de.a,{className:e.classes.paper,children:Object(r.jsx)(jr,{})})}),Object(r.jsx)(le.a,{item:!0,xs:12,children:Object(r.jsx)(wr,{})})]})}));const yr={name:"",enumTypeId:1,disabled:!1,key:0};class Cr extends n.a.Component{constructor(e){var t;super(e),t=this,this.handleChange=(e,t)=>{this.setState({[e]:t})},this.handleSubmit=Object(fe.a)(he.a.mark((function e(){var a,r,s,n;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.store,r=a.addEnum,s=a.refreshEnums,n=a.editEnum,e.prev=1,!t.state._id){e.next=7;break}return e.next=5,n(t.state);case 5:e.next=9;break;case 7:return e.next=9,r(t.state);case 9:s(),t.setState(yr),t.props.onSubmit&&t.props.onSubmit(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),t.props.user.showError(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,14]])}))),this.state=e.data||yr}render(){const e=this.props,t=e.classes,a=e.disabled,s=this.state,n=s.name,i=s.enumTypeId,c=s.key,o=this.props.store.enumTypes;return Object(r.jsxs)(Le,{onSubmit:this.handleSubmit,inline:!0,disabled:a,children:[Object(r.jsx)("div",{className:t.nameTextInput,children:Object(r.jsx)(Ce,{value:n,field:"name",onChange:this.handleChange,fullWidth:!0,required:!0,disabled:a})}),Object(r.jsx)(Ee,{value:i,field:"enumTypeId",onChange:this.handleChange,data:o.data,textField:"name",required:!0,disabled:a}),Object(r.jsx)(Se,{value:c,field:"key",onChange:this.handleChange,min:0,step:1,required:!0}),Object(r.jsx)(Ka,{label:"",value:this.state.disabled,field:"disabled",onChange:this.handleChange})]})}}var Sr=g(Object(X.withStyles)((e=>({nameTextInput:{display:"flex",flex:1}}))),Me,w)(Cr);const Tr=[{field:"name",disablePadding:!0},{field:"_enumType.name",type:"enum",data:"enumTypes",idField:"enumTypeId",sortable:!1},{field:"key",type:"num"},{field:"disabled",type:"bool"}];class Dr extends n.a.Component{constructor(e){var t;super(e),t=this,this.handleChangeClient=(e,t)=>{this.setState({clientId:t})},this.handleClose=()=>{this.setState({isOpen:!1})},this.handleOpen=()=>{this.setState({isOpen:!0})},this.handleChange=function(){var e=Object(fe.a)(he.a.mark((function e(a,r,s,n){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.props.store.getEnums(a,s,r,n);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),t.props.user.showError(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a,r,s){return e.apply(this,arguments)}}(),this.onEdit=function(){var e=Object(fe.a)(he.a.mark((function e(a){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.setState({x:a,isOpen:!0});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.isDisabled=e=>!1,this.state={x:null,isOpen:!1}}render(){const e=this.props.store.deleteEnum,t=this.props.translate;return Object(r.jsxs)("div",{children:[Object(r.jsx)(Jt,{rows:Tr,data:"enums",onChange:this.handleChange,onDelete:e,title:t("enums"),onEdit:this.onEdit,store:this.props.store,filters:[],isDisabled:this.isDisabled,filename:"enums"}),Object(r.jsx)(Kt,{title:t("enum"),onClose:this.handleClose,isOpen:this.state.isOpen,children:Object(r.jsx)(Sr,{data:this.state.x,onSubmit:this.handleClose})})]})}}var Ir=g(Me,w,se)(Dr);var _r=g(Object(X.withStyles)((e=>({paper:{padding:e.spacing.unit}}))),w)((function(e){return Object(r.jsxs)(le.a,{container:!0,spacing:16,children:[Object(r.jsx)(le.a,{item:!0,xs:12,children:Object(r.jsx)(de.a,{className:e.classes.paper,children:Object(r.jsx)(Sr,{})})}),Object(r.jsx)(le.a,{item:!0,xs:12,children:Object(r.jsx)(Ir,{})})]})})),Er=a(325),Nr=a(107),Pr=a(326),Fr=a(327);a(720),a(721),a(722),a(723);class Lr extends n.a.Component{constructor(...e){super(...e),this.calendarComponentRef=n.a.createRef(),this.state={defaultView:"dayGridMonth",defaultDate:new Date},this.eventDataTransform=e=>(e.id=e._id,e.title=e[this.props.textField],e.color=this.props.getColor(e),e),this.handleDateClick=e=>{this.props.onSelect(null,e.date)},this.handleEventClick=e=>{const t=this.props.data.data.find((t=>t._id===e.event.id));this.props.onSelect(t,e.date)},this.handleViewDisplay=e=>{const t=[{field:"start",op:"gte",value:e.view.activeStart},{field:"end",op:"lte",value:e.view.activeEnd}];this.props.onChange(t,{limit:200,skip:0},null),this.setState({defaultView:e.view.type,defaultDate:e.view.activeStart})}}render(){const e=this.state,t=e.defaultDate,a=e.defaultView;return Object(r.jsx)("div",{className:"Calendar",children:Object(r.jsx)(Er.a,{defaultView:a,defaultDate:t,header:{left:"today, prev, next, title",right:"dayGridMonth, timeGridWeek, timeGridDay"},plugins:[Nr.d,Pr.a,Fr.a],ref:this.calendarComponentRef,weekends:!0,events:this.props.data.data,dateClick:this.handleDateClick,eventClick:this.handleEventClick,eventDataTransform:this.eventDataTransform,datesRender:this.handleViewDisplay,eventColor:this.props.theme.palette.primary.main})})}}var Rr=Object(X.withTheme)()(Lr);class Mr extends n.a.Component{constructor(e){var t;super(e),t=this,this.getColor=e=>{const t=this.props.theme;if(!e._eventType)return t.palette.secondary.main;switch(e._eventType.key){case 1:return t.palette.primary.main;default:return t.palette.secondary.main}},this.handleSelect=(e,t)=>{this.setState({x:e,isOpen:!0,date:t})},this.handleClose=()=>{this.setState({isOpen:!1})},this.handleChange=function(){var e=Object(fe.a)(he.a.mark((function e(a,r,s){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.props.store.getEvents(a,r);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),t.props.user.showError(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a,r){return e.apply(this,arguments)}}(),this.state={x:null,isOpen:!1,date:null}}render(){const e=this.props.store.events,t=this.props.user.user,a=this.state.x&&this.state.x.userId!==t._id;return Object(r.jsx)(le.a,{container:!0,spacing:16,children:Object(r.jsx)(le.a,{item:!0,xs:12,children:Object(r.jsxs)(de.a,{className:this.props.classes.paper,children:[Object(r.jsx)(Rr,{onSelect:this.handleSelect,onChange:this.handleChange,textField:"name",data:e,getColor:this.getColor}),Object(r.jsx)(Kt,{title:"Event",onClose:this.handleClose,isOpen:this.state.isOpen,children:Object(r.jsx)(jr,{data:this.state.x,onSubmit:this.handleClose,date:this.state.date,disabled:a})})]})})})}}var Ar=g(Object(X.withStyles)((e=>({paper:{padding:e.spacing.unit}}))),w,Me,Object(X.withTheme)())(Mr),Ur=a(328),Wr=a.n(Ur);class qr extends s.Component{constructor(e){super(e),this.state={delay:500,legacy:!0},this.handleScan=this.handleScan.bind(this),this.openImageDialog=this.openImageDialog.bind(this),this.myRef=n.a.createRef()}handleScan(e){if(e){const a=e.split(".");if(2===a.length)try{this.props.user.verify(a[0],a[1])}catch(t){this.props.user.showError(t)}}}handleError(e){console.error(e)}openImageDialog(){this.setState({legacy:!0},(()=>{this.myRef.current.openImageDialog()}))}render(){const e=this.props.classes;return Object(r.jsxs)("div",{className:e.row,children:[Object(r.jsx)("div",{className:e.col,children:Object(r.jsxs)("div",{className:e.center,children:[Object(r.jsx)(Wr.a,{ref:this.myRef,delay:this.state.delay,style:{height:320,width:320},onError:this.handleError,onScan:this.handleScan,legacyMode:this.state.legacy}),Object(r.jsx)(Pe.a,{variant:"contained",color:"primary",className:e.submit,onClick:this.openImageDialog,children:"Scan"})]})}),Object(r.jsx)("div",{className:e.col,children:Object(r.jsxs)(de.a,{className:e.paper,children:[Object(r.jsx)(V.a,{variant:"h6",children:"Data"}),this.props.user.signature&&Object(r.jsx)("div",{children:Object(r.jsx)(V.a,{variant:"body1",children:this.props.user.signature.data})})]})})]})}}var zr=g(Object(X.withStyles)((e=>Object(o.a)({},Aa(e)))),Me,w)(qr);class Br extends s.Component{constructor(e){super(e),this.handleSubmit=()=>{try{this.props.user.sign(this.state.data)}catch(e){this.props.user.showError(e)}},this.handleChange=(e,t)=>{this.setState({[e]:t})},this.state={data:""}}render(){const e=this.props.classes;return Object(r.jsxs)("div",{className:e.row,children:[Object(r.jsx)("div",{className:e.col,children:Object(r.jsx)(de.a,{className:e.paper,children:Object(r.jsx)(Le,{onSubmit:this.handleSubmit,children:Object(r.jsx)("div",{className:e.flex,children:Object(r.jsx)(Ce,{label:"Data",value:this.state.data,field:"data",onChange:this.handleChange,required:!0,multiline:!0,fullWidth:!0,rows:8})})})})}),Object(r.jsx)("div",{className:e.col,children:Object(r.jsx)("div",{className:e.center,children:this.props.user.signature&&Object(r.jsx)("img",{src:"data:image/jpeg;base64,"+this.props.user.signature.qrCode,alt:"signature",width:320,height:320})})})]})}}var Vr=g(Object(X.withStyles)((e=>Object(o.a)({},Aa(e)))),Me,w)(Br),Jr=a(330),Kr=a.n(Jr);var Hr=Object(X.withStyles)((e=>({})))((function(e){const t=e.color,a=e.onClick,s=e.tooltip,n=e.disabled,i=e.className;return Object(r.jsx)(at.a,{title:s,children:Object(r.jsx)(b.a,{color:t,onClick:a,"aria-label":s,disabled:n,className:i,children:e.children})})}));class Yr extends n.a.Component{constructor(e){var t;super(e),t=this,this.onChange=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r,s,n;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),r=a.target.files[0],"image/jpeg"!==t.props.mimeType){e.next=8;break}return s=window.URL||window.webkitURL,n=s.createObjectURL(r),e.next=7,t.props.utils.resize(n,640,r.name);case 7:r=e.sent;case 8:t.props.onChange(t.props.field,r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.onClick=()=>{this.props.disabled||this.inputRef.current.click()},this.inputRef=n.a.createRef()}render(){const e=this.props,t=e.classes,a=e.value,s=e.disabled,n=e.mimeType;return Object(r.jsxs)("div",{children:[Object(r.jsx)(Hr,{className:t.button,tooltip:"Attach file",color:a?"primary":"default",onClick:this.onClick,disabled:s,children:Object(r.jsx)(Kr.a,{})}),Object(r.jsx)("input",{ref:this.inputRef,style:{display:"none"},type:"file",accept:n,onChange:this.onChange})]})}}var Gr=Ua(Object(X.withStyles)((e=>Object(o.a)(Object(o.a)({},Aa(e)),{},{button:{margin:e.spacing.unit}})))(Yr));const Zr={name:"",likes:[],likesCnt:0,typesId:[],unavailable:!1,_img:null};class Xr extends n.a.Component{constructor(...e){var t;super(...e),t=this,this.state=this.props.data||Zr,this.handleChange=(e,t)=>{this.setState({[e]:t})},this.handleSubmit=Object(fe.a)(he.a.mark((function e(){var a,r,s,n,i,c;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.store,r=a.addTag,s=a.getTags,n=a.editTag,i=a.tags,c=t.props.user.user,e.prev=2,!t.state._id){e.next=8;break}return e.next=6,n(t.state,c);case 6:e.next=10;break;case 8:return e.next=10,r(t.state,c);case 10:s(i.filters),t.setState(Zr),t.props.onSubmit&&t.props.onSubmit(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),t.props.user.showError(e.t0);case 18:case"end":return e.stop()}}),e,null,[[2,15]])})))}render(){const e=this.props.classes,t=this.state,a=t.name,s=t.typesId,n=t.disabled,i=t._img,c=this.props.store.enums;return Object(r.jsxs)(Le,{onSubmit:this.handleSubmit,inline:!0,children:[Object(r.jsx)(Ce,{label:"Name",value:a,field:"name",onChange:this.handleChange,required:!0}),Object(r.jsx)("div",{className:e.collaborators,children:Object(r.jsx)(Ee,{label:"Types",value:s,field:"typesId",onChange:this.handleChange,data:c.data,textField:"name",fullWidth:!0,multiple:!0})}),Object(r.jsx)(Gr,{mimeType:"image/jpeg",value:i,field:"_img",onChange:this.handleChange,disabled:void 0!==this.state._id}),Object(r.jsx)(Ka,{label:"",value:n,field:"disabled",onChange:this.handleChange})]})}}var $r=g(Object(X.withStyles)((e=>({collaborators:{display:"flex",flex:1}}))),Me,w)(Xr),Qr=a(338),es=a.n(Qr),ts=a(339),as=a.n(ts),rs=a(332),ss=a.n(rs),ns=a(333),is=a.n(ns),cs=a(334),os=a.n(cs),ls=a(199),us=a.n(ls),ds=a(335),ps=a.n(ds),hs=a(337),fs=a.n(hs),bs=a(189),xs=a.n(bs),ms=a(336),js=a.n(ms),vs=a(331),gs=a.n(vs);class Os extends n.a.Component{constructor(...e){var t;super(...e),t=this,this.state={imgViz:!1,img:null},this.state={expanded:!1},this.handleExpandClick=()=>{this.setState((e=>({expanded:!e.expanded})))},this.onViz=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r,s;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.props.onViz();case 2:r=e.sent,t.setState({imgViz:!0}),r&&((s=new FileReader).onloadend=()=>{t.setState({img:s.result})},s.readAsDataURL(r));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}render(){const e=this.props,t=e.classes,a=e.actions,s=e.children,n=e.cardActions,i=e.primary,c=e.secondary,o=e.avatar,l=e.defaultAvatar,u=e.tooltip,d=e.content;return Object(r.jsx)(gs.a,{partialVisibility:!0,onChange:this.onViz,children:Object(r.jsxs)(ss.a,{className:t.card,children:[Object(r.jsx)(is.a,{avatar:Object(r.jsx)(Ma,{className:t.bigAvatar,defaultValue:l,value:o,tooltip:u}),action:a,title:i,subheader:c}),Object(r.jsx)(os.a,{className:t.media,image:this.state.img||"https://next.material-ui.com/static/images/cards/paella.jpg",title:"media",style:{opacity:this.state.imgViz?1:.25,transition:"opacity 500ms linear"}}),Object(r.jsx)(us.a,{children:d}),Object(r.jsxs)(ps.a,{className:t.actions,disableActionSpacing:!0,children:[n,s&&Object(r.jsx)(b.a,{className:it()(t.expand,{[t.expandOpen]:this.state.expanded}),onClick:this.handleExpandClick,"aria-expanded":this.state.expanded,"aria-label":"Show more",children:Object(r.jsx)(js.a,{})})]}),Object(r.jsx)(fs.a,{in:this.state.expanded,timeout:"auto",unmountOnExit:!0,children:Object(r.jsx)(us.a,{children:s})})]})})}}var ws=Object(X.withStyles)((e=>({card:{margin:e.spacing.unit,width:"100%",maxWidth:480},media:{height:0,paddingTop:"56.25%"},actions:{display:"flex"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:xs.a[500]}})))(Os);var ks=Object(X.withStyles)((e=>({root:{paddingRight:e.spacing.unit},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(bt.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 auto"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}})))((e=>{const t=e.classes,a=e.onFilter,s=e.title,n=e.isFilterSet,i=e.actions,c=e.onRefresh;return Object(r.jsxs)(z.a,{className:t.root,children:[Object(r.jsx)("div",{className:t.title,children:Object(r.jsx)(V.a,{variant:"h6",id:"tableTitle",children:s})}),Object(r.jsx)("div",{className:t.spacer}),Object(r.jsxs)("div",{className:t.actions,children:[i,Object(r.jsx)(at.a,{title:"Filter list",children:Object(r.jsx)(b.a,{"aria-label":"Filter list",color:n?"primary":"default",onClick:a,children:Object(r.jsx)(pt.a,{})})}),Object(r.jsx)(at.a,{title:"Refresh list",children:Object(r.jsx)(b.a,{"aria-label":"Refresh list",onClick:c,children:Object(r.jsx)(ft.a,{})})})]})]})}));class ys extends n.a.Component{constructor(e){var t;super(e),t=this,this.handleOpenFilter=()=>{this.setState({isOpenFilter:!0})},this.handleCloseFilter=()=>{this.setState({isOpenFilter:!1})},this.onDelete=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r,s,n;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props,s=r.onDelete,n=r.onChange,e.next=3,s(a);case 3:n(t.state.filters);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleConfirmFilter=e=>{const t=_t(this.props.rows,this.props.filters,e);this.props.onChange(t),this.setState({filters:t,isOpenFilter:!1})},this.handleRefresh=()=>{this.props.onChange(this.state.filters)},this.state={isOpenFilter:!1,filters:_t(e.rows,e.filters,e.defaultFilters)},this.exportRef=n.a.createRef()}componentDidMount(){this.props.onChange(this.state.filters)}render(){const e=this.props,t=e.data,a=e.primaryTextField,s=e.secondaryTextField,n=e.onEdit,i=e.isDisabled,c=e.classes,o=e.onLike,l=e.isLiked,u=e.avatarField,d=e.defaultAvatarField,p=e.tooltipField,h=e.onMsg,f=e.cntField,b=e.theme,x=e.onViz;return Object(r.jsxs)(de.a,{className:c.listWrapper,children:[Object(r.jsx)(ks,{onFilter:this.handleOpenFilter,isFilterSet:this.state.filters.length>0,actions:this.props.actions,title:this.props.title,onRefresh:this.handleRefresh}),Object(r.jsx)(Ut,{isLoading:t.isLoading}),Object(r.jsx)("div",{className:c.list,children:t.data.map((e=>Object(r.jsx)(ws,{content:this.props.getContent(e),primary:zt.a.get(e,a),secondary:zt.a.get(e,s),avatar:zt.a.get(e,u),defaultAvatar:zt.a.get(e,d),tooltip:zt.a.get(e,p),onLike:()=>o(e),onViz:()=>x(e),actions:Object(r.jsx)(Rt,{disabled:i(e),onEdit:()=>n(e),onDelete:()=>this.onDelete(e)}),cardActions:Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(at.a,{title:"Like",children:Object(r.jsxs)(Pe.a,{onClick:()=>o(e._id),style:{color:l(e)?b.palette.primary.main:"rgba(0, 0, 0, 0.54)"},children:[Object(r.jsx)(es.a,{}),zt.a.get(e,f)]})}),Object(r.jsx)(Hr,{tooltip:"Send message",onClick:()=>h(e),children:Object(r.jsx)(as.a,{})})]})})))}),Object(r.jsx)(Nt,{isOpen:this.state.isOpenFilter,onClose:this.handleCloseFilter,onConfirm:this.handleConfirmFilter,store:this.props.store,rows:this.props.rows,filters:this.props.filters,defaultState:this.props.defaultFilters})]})}}var Cs=Object(X.withTheme)()(Object(X.withStyles)((e=>({listWrapper:{position:"relative"},list:{display:"flex",flexWrap:"wrap"}})))(ys));const Ss=[{field:"user.name",label:"Tag",type:"enum",data:"enums",idField:"typesId"}];class Ts extends n.a.Component{constructor(...e){var t;super(...e),t=this,this.state={x:null,isOpen:!1},this.handleClose=()=>{this.setState({isOpen:!1})},this.handleOpen=()=>{this.setState({isOpen:!0})},this.handleChange=function(){var e=Object(fe.a)(he.a.mark((function e(a){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.props.store.getTags(a);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),t.props.user.showError(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),this.handleEdit=e=>{this.setState({x:e,isOpen:!0})},this.handleDelete=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props.store.deleteTag,e.prev=1,e.next=4,r(a);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),t.props.user.showError(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),this.isDisabled=e=>this.props.user.user._id!==e.userId,this.handleLike=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r,s;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.props.store.likeTag,s=t.props.user.user,e.prev=2,e.next=5,r(a,s);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),t.props.user.showError(e.t0);case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}(),this.handleMsg=e=>{const t=this.props.user.user;window.open("mailto:".concat(e._user.email,"?subject=APP: ").concat(e.name,"&body=%0D%0A").concat(t.name),"_self")},this.isLiked=e=>e.likes.includes(this.props.user.user._id),this.getContent=e=>Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(V.a,{variant:"subtitle1",color:"textPrimary",children:e.name}),Object(r.jsx)(V.a,{variant:"body2",color:"textSecondary",component:"p",children:e._tagTypesStr||"\u017eiadne"})]}),this.getFilters=()=>[{label:"Likes",field:"likes",data:[{_id:1,name:"Me",filters:[{field:"likes",value:this.props.user.user._id}]}]}],this.handleViz=function(){var e=Object(fe.a)(he.a.mark((function e(a){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.imgId){e.next=6;break}return e.next=3,t.props.store.getFile(a.imgId);case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=null;case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}render(){const e=this.props.classes,t=this.props.store.tags;return Object(r.jsxs)("div",{className:e.list,children:[Object(r.jsx)(Cs,{data:t,getContent:this.getContent,primaryTextField:"_user.name",secondaryTextField:"_dateStr",avatarField:"_user.avatar",tooltipField:"_user.name",cntField:"likesCnt",onChange:this.handleChange,onEdit:this.handleEdit,onDelete:this.handleDelete,isDisabled:this.isDisabled,onLike:this.handleLike,isLiked:this.isLiked,filters:this.getFilters(),onViz:this.handleViz,rows:Ss,store:this.props.store,title:"Tags",onMsg:this.handleMsg}),Object(r.jsx)(Kt,{title:"Edit tag",onClose:this.handleClose,isOpen:this.state.isOpen,children:Object(r.jsx)($r,{data:this.state.x,onSubmit:this.handleClose})})]})}}var Ds=g(Object(X.withStyles)((e=>({list:{marginTop:e.spacing.unit}}))),Me,w,d.f)(Ts);var Is=Object(X.withStyles)((e=>({paper:{padding:e.spacing.unit}})))((function(e){return Object(r.jsx)(le.a,{container:!0,spacing:24,children:Object(r.jsxs)(le.a,{item:!0,xs:12,children:[Object(r.jsx)(de.a,{className:e.classes.paper,children:Object(r.jsx)($r,{})}),Object(r.jsx)(Ds,{})]})})}));const _s=e=>[{_id:1,name:e("totalDistance")},{_id:2,name:e("totalElevation")},{_id:3,name:e("totalTime")},{_id:8,name:e("totalKudos")},{_id:4,name:e("maxDistance")},{_id:5,name:e("maxElevation")},{_id:6,name:e("maxTime")},{_id:9,name:e("maxKudos")},{_id:7,name:e("count")}],Es=e=>[{_id:1,name:e("thisWeek")},{_id:2,name:e("lastWeek")},{_id:3,name:e("thisMonth")},{_id:4,name:e("lastMonth")},{_id:5,name:e("thisYear")},{_id:6,name:e("myMonths")},{_id:7,name:e("myYears")}],Ns=e=>[{_id:0,name:e("all")},{_id:1,name:e("ride")},{_id:2,name:e("run")},{_id:3,name:e("walk")},{_id:4,name:e("hike")}],Ps=e=>{switch(e){case 6:return"month";case 7:return"year";default:return"userId"}},Fs=e=>{switch(e){case 1:case 2:case 3:case 8:return"sum";case 4:case 5:case 6:case 9:return"max";case 7:default:return"count"}},Ls=e=>{switch(e){case 1:case 4:return"dis";case 2:case 5:return"total_elevation_gain";case 3:case 6:return"moving_time";case 8:case 9:return"kudos_count";default:return"_id"}},Rs=(e,t)=>({field:Ps(e),op:Fs(t),opField:Ls(t)}),Ms=(e,t)=>{switch(e){case 1:return[{field:"start_date",op:"lte",value:It()().endOf("week").toDate()},{field:"start_date",op:"gte",value:It()().startOf("week").toDate()}];case 2:return[{field:"start_date",op:"lte",value:It()().subtract(1,"weeks").endOf("week").toDate()},{field:"start_date",op:"gte",value:It()().subtract(1,"weeks").startOf("week").toDate()}];case 3:return[{field:"start_date",op:"lte",value:It()().endOf("month").toDate()},{field:"start_date",op:"gte",value:It()().startOf("month").toDate()}];case 4:return[{field:"start_date",op:"lte",value:It()().subtract(1,"month").endOf("month").toDate()},{field:"start_date",op:"gte",value:It()().subtract(1,"month").startOf("month").toDate()}];case 5:return[{field:"start_date",op:"lte",value:It()().endOf("year").toDate()},{field:"start_date",op:"gte",value:It()().startOf("year").toDate()}];case 6:case 7:return[{field:"userId",value:t._id}];default:return[]}},As=e=>{if(!e._user)return null;const t=zt.a.get(e,"_user.name");return Object(r.jsx)(ta.a,{color:"inherit",href:"https://www.strava.com/athletes/".concat(e._user.strava.oAuthId),target:"_blank",rel:"noopener noreferrer",children:t})},Us=(e,t)=>{switch(e){case 6:return{field:"_id",label:t("months"),filterable:!1,disablePadding:!0};case 7:return{field:"_id",label:t("years"),filterable:!1,disablePadding:!0};default:return{field:"_user.name",label:t("user"),filterable:!1,sortable:!1,disablePadding:!0,cell:As}}},Ws=(e,t)=>{switch(e){case 1:case 4:return{field:"val",label:t("distance"),filterable:!1};case 2:case 5:return{field:"val",label:t("elevation"),filterable:!1};case 3:case 6:return{field:"val",label:t("time"),filterable:!1};case 7:return{field:"val",label:t("count"),filterable:!1};case 8:case 9:return{field:"val",label:t("kudos"),filterable:!1};default:return{field:"val",label:t("value"),filterable:!1}}},qs=(e,t,a)=>[Us(e,a),Ws(t,a)],zs=(e,t)=>[{field:"club",data:[{_id:1,name:"VYPADNI VON",filters:[{field:"userId",op:"in",value:()=>e(562456)}]},{_id:2,name:"TATRANSK\xc9 KOZY",filters:[{field:"userId",op:"in",value:()=>e(771781)}]},{_id:3,name:"ME",filters:[{field:"userId",value:t._id}]}]},{field:"sex",data:[{_id:1,name:"Male",filters:[{field:"sex",op:"eq",value:"M"}]},{_id:2,name:"Female",filters:[{field:"sex",op:"eq",value:"F"}]}]}];let Bs,Vs,Js,Ks,Hs,Ys,Gs,Zs;class Xs extends n.a.Component{constructor(e){var t;super(e),t=this,this.handleChange=(e,t,a)=>{Hs=e,Vs=a,Js=t,this.getList()},this.getList=Object(fe.a)(he.a.mark((function e(){var a;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=[...Bs,...Hs,...Ys,...Zs],e.next=4,t.props.store.getActivities(Ks,a,Js,Vs,t.props.locale);case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(0),t.props.user.showError(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),this.isDisabled=e=>!0,this.handleChangeType=(e,t)=>{this.setState({[e]:t}),Ys=(e=>{switch(e){case 1:return[{field:"type",value:"Ride"}];case 2:return[{field:"type",value:"Run"}];case 3:return[{field:"type",value:"Walk"}];case 4:return[{field:"type",value:"Hike"}];case 0:default:return[]}})(t),this.getList()},this.handleChangeOp=(e,t)=>{this.setState({[e]:t}),Ks=Rs(this.state.groupId,t),this.getList()},this.handleChangeGroup=(e,t)=>{const a=this.props.user.user;this.setState({[e]:t}),Bs=Ms(t,a),Ks=Rs(t,this.state.opId),this.getList()},this.handleChangeSearch=(e,t)=>{this.setState({[e]:t}),clearTimeout(Gs),Gs=setTimeout((()=>{Zs=t?[{field:"name",op:"regex",value:t}]:[],this.getList()}),500)};this.state={opId:1,groupId:1,typeId:0,search:""},Bs=Ms(1,e.user.user),Ks=Rs(1,1),Ys=[],Zs=[]}render(){const e=this.state,t=e.opId,a=e.groupId,s=e.typeId,n=this.props,i=n.classes,c=n.translate;return Object(r.jsxs)("div",{children:[Object(r.jsxs)(de.a,{className:it()(i.paper,i.row),children:[Object(r.jsx)(Ee,{value:s,field:"typeId",onChange:this.handleChangeType,data:Ns(c),textField:"name",required:!0}),Object(r.jsx)(Ee,{value:t,field:"opId",onChange:this.handleChangeOp,data:_s(c),textField:"name",required:!0}),Object(r.jsx)(Ee,{value:a,field:"groupId",onChange:this.handleChangeGroup,data:Es(c),textField:"name",required:!0}),Object(r.jsx)("div",{className:i.grow}),this.props.user.user.strava&&Object(r.jsx)(la,{config:pa.strava,title:c("sync")})]}),Object(r.jsx)(Jt,{rows:qs(this.state.groupId,this.state.opId,c),data:"activities",onChange:this.handleChange,title:c("activities"),store:this.props.store,filters:zs(this.props.store.getUsersInClub,this.props.user.user),defaultSort:{field:"val",dir:"desc"},isDisabled:this.isDisabled}),Object(r.jsx)(V.a,{variant:"body1",className:this.props.classes.footer,children:c("rideNote")})]})}}var $s=g(Me,w,Object(X.withStyles)((e=>Object(o.a)(Object(o.a)({},Aa(e)),{},{paper:{marginBottom:e.spacing.unit,padding:e.spacing.unit},footer:{marginTop:e.spacing.unit}}))),se)(Xs);var Qs=g(Object(X.withStyles)((e=>({paper:{padding:e.spacing.unit}}))),w)((function(e){return Object(r.jsx)(le.a,{container:!0,spacing:16,children:Object(r.jsx)(le.a,{item:!0,xs:12,children:Object(r.jsx)($s,{})})})}));var en=[{name:"records",path:"/records",component:Xt,exact:!0,permission:Xa.tasks},{name:"clients",path:"/clients",component:br,exact:!0,permission:Xa.report},{name:"projects",path:"/projects",component:Ca,exact:!0,permission:Xa.tasks},{name:"reports",path:"/reports",component:sr,exact:!0,permission:Xa.tasks},{name:"events",path:"/events",component:kr,exact:!0,permission:Xa.events},{name:"enums",path:"/enums",component:_r,exact:!0,permission:Xa.enums},{name:"calendar",path:"/calendar",component:Ar,exact:!0,permission:Xa.events},{name:"sign",path:"/sign",component:Vr,exact:!0,permission:Xa.report},{name:"verify",path:"/verify",component:zr,exact:!0,permission:Xa.report},{name:"project",path:"/projects/:id",component:Fa,permission:Xa.tasks},{name:"login",path:"/login",component:ba,anonymous:!0,exact:!0,hidden:!0},{name:"oauth",path:"/",component:lr,anonymous:!0,exact:!0,hidden:!0},{name:"tags",path:"/tags",component:Is,exact:!0,permission:Xa.tags},{name:"activities",path:"/activities",component:Qs,exact:!0,permission:Xa.activities},{name:"account",path:"/account",component:$a,exact:!0}];let tn="/";class an extends n.a.Component{constructor(e){super(e);{const e=new URL("https://krdeldatlov.sk");tn=e.pathname}}render(){const e=this.props,t=e.user,a=e.classes;return Object(r.jsxs)(n.a.Fragment,{children:[Object(r.jsx)(u.a,{basename:tn,children:Object(r.jsx)(ce,{user:t,routes:en,children:en.map((e=>e.anonymous?Object(r.jsx)(d.b,{path:e.path,exact:e.exact,component:e.component},e.name):Object(r.jsx)(rn,{exact:e.exact,path:e.path,component:e.component,user:t,permission:e.permission},e.name)))})}),Object(r.jsx)(h.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:t.msg,autoHideDuration:6e3,onClose:t.hideMsg,ContentProps:{"aria-describedby":"message-id"},message:Object(r.jsx)("span",{id:"message-id",children:t.msg}),action:[Object(r.jsx)(b.a,{"aria-label":"Close",color:"inherit",className:a.close,onClick:t.hideMsg,children:Object(r.jsx)(m.a,{})},"close")]})]})}}function rn(e){let t=e.component,a=e.user,s=e.permission,n=Object(l.a)(e,["component","user","permission"]);return Object(r.jsx)(d.b,Object(o.a)(Object(o.a)({},n),{},{render:e=>a.user?s&&!a.hasPermission(s)?Object(r.jsx)(d.a,{to:{pathname:pa.home,state:{from:e.location}}}):Object(r.jsx)(t,Object(o.a)({},e)):Object(r.jsx)(d.a,{to:{pathname:"/login",state:{from:e.location}}})}))}var sn=g(v()((e=>({close:{padding:e.spacing.unit/2}}))),w)(an);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var nn=a(14);const cn=function(){var e=Object(fe.a)(he.a.mark((function e(t,a,r=""){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.auth.auth(t,a,r);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}(),on=e=>{let t="https://krdeldatlov.sk";return"5"===e&&(t+="/"),"".concat(t,"?provider=").concat(e)},ln=function(){var e=Object(fe.a)(he.a.mark((function e(t,a){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.auth.oAuth(t,a,on(t),pa.configId);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}(),un=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.auth.reset(t,"https://krdeldatlov.sk");case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),dn=function(){var e=Object(fe.a)(he.a.mark((function e(t,a){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.auth.updateOauth(t,a,on(t));case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}(),pn=function(){var e=Object(fe.a)(he.a.mark((function e(){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.auth.generateSecret();case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),hn=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.auth.sign(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),fn=function(){var e=Object(fe.a)(he.a.mark((function e(t,a){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.auth.verify(t,a);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}(),bn=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.auth.getUsers(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),xn=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.auth.getUserCached(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),mn=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.auth.getUser(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),jn=function(){var e=Object(fe.a)(he.a.mark((function e(t,a){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.auth.updateUser(t,a);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}(),vn=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.auth.checkUser(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();class gn extends n.a.Component{constructor(...e){var t;super(...e),t=this,this.state={user:nn.storage.getUser(),msg:null,users:{total:0,data:[]},secret:null,signature:null},this.showMsg=e=>{this.setState({msg:e})},this.showError=e=>{this.setState({msg:e.message})},this.hideMsg=()=>{this.setState({msg:null})},this.auth=function(){var e=Object(fe.a)(he.a.mark((function e(a,r,s){var n;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,cn(a,r,s);case 3:return n=e.sent,t.setState({user:n}),e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a,r){return e.apply(this,arguments)}}(),this.generateSecret=Object(fe.a)(he.a.mark((function e(){var a;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,pn();case 3:a=e.sent,t.setState({secret:a}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),this.sign=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,hn(btoa(a));case 3:r=e.sent,t.setState({signature:r}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),this.verify=function(){var e=Object(fe.a)(he.a.mark((function e(a,r){var s;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fn(a,r);case 3:s=e.sent,t.setState({signature:{data:s?atob(a):"NOT VALID",signature:r}}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a){return e.apply(this,arguments)}}(),this.oAuth=function(){var e=Object(fe.a)(he.a.mark((function e(a,r){var s;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ln(a,r);case 3:return s=e.sent,t.setState({user:s}),e.abrupt("return",s);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}(),this.updateOauth=function(){var e=Object(fe.a)(he.a.mark((function e(a,r){var s;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,dn(a,r);case 3:s=e.sent,t.setState({user:s}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a){return e.apply(this,arguments)}}(),this.updateUser=function(){var e=Object(fe.a)(he.a.mark((function e(a,r){var s;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,jn(a,r);case 3:return s=e.sent,t.setState({user:s}),e.abrupt("return",s);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}(),this.reset=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,un(t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),this.getUsers=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,bn(a);case 3:r=e.sent,t.setState({users:r}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),this.hasPermission=e=>this.state.user&&(this.state.user.permissions&e)>0}render(){const e=this.props.children;return Object(r.jsx)(O.Provider,{value:Object(o.a)({auth:this.auth,hideMsg:this.hideMsg,showMsg:this.showMsg,showError:this.showError,generateSecret:this.generateSecret,oAuth:this.oAuth,updateOauth:this.updateOauth,getUsers:this.getUsers,getUser:mn,updateUser:this.updateUser,hasPermission:this.hasPermission,reset:this.reset,sign:this.sign,verify:this.verify,checkUser:vn},this.state),children:e})}}var On=gn,wn=a(56);a(200);const kn="timeRecords",yn="projects",Cn="tasks",Sn="clients",Tn="events",Dn="tags",In="enums",_n=function(){var e=Object(fe.a)(he.a.mark((function e(t,a){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.date.setHours(0,0,0,0),e.next=5,nn.store.post(kn,t);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a){return e.apply(this,arguments)}}(),En=function(){var e=Object(fe.a)(he.a.mark((function e(t,a){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.start.setSeconds(0,0),t.end.setSeconds(0,0),e.next=6,nn.store.post(Tn,t);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}(),Nn=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.post(In,t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),Pn=function(){var e=Object(fe.a)(he.a.mark((function e(t,a){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.collaborators=[...t.collaborators,a._id],e.next=5,nn.store.post(yn,t);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a){return e.apply(this,arguments)}}(),Fn=function(){var e=Object(fe.a)(he.a.mark((function e(t,a){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,e.next=4,nn.store.post(Sn,t);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}(),Ln=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.postFile(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),Rn=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.getFile(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),Mn=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.delFile(t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),An=function(){var e=Object(fe.a)(he.a.mark((function e(t,a){var r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.date=new Date,e.next=5,nn.store.getLocation();case 5:if(t.location=e.sent,!t._img){e.next=12;break}return e.next=9,Ln(t._img);case 9:r=e.sent,t.imgId=r._id,t._img=null;case 12:return e.next=14,nn.store.post(Dn,t);case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(0),e.t0;case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,a){return e.apply(this,arguments)}}(),Un=function(){var e=Object(fe.a)(he.a.mark((function e(t,a){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.collaborators=[...t.collaborators,a._id],e.next=4,nn.store.put(yn,t,t._id);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}(),Wn=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.date.setHours(0,0,0,0),e.next=4,nn.store.put(kn,t,t._id);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),qn=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.put(Tn,t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),zn=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.put(In,t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),Bn=function(){var e=Object(fe.a)(he.a.mark((function e(){var t,a,r,s;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=nn.storage.getUser(),a={field:"key",dir:"asc"},r=[{field:"collaborators",op:"eq",value:t._id}],e.next=6,nn.store.get(yn,r,a);case 6:return(s=e.sent).data.forEach((e=>{e.collaborators=e.collaborators.filter((e=>e!==t._id))})),e.abrupt("return",s);case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),Vn=function(){var e=Object(fe.a)(he.a.mark((function e(t,a){var r,s,n,i,c,o,l,u,d;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.getLocation();case 3:return(r=e.sent).max=null,s=It()().subtract(1,"day").toDate(),n=[...t,{field:"location",op:"near",value:r},{field:"date",op:"gt",value:s}],i={field:"location",dir:"asc"},e.next=10,nn.store.get(Dn,n,i);case 10:(c=e.sent).filters=t,o=Object(wn.a)(c.data),e.prev=13,o.s();case 15:if((l=o.n()).done){e.next=27;break}return(u=l.value).date=u.date?new Date(u.date):null,u._dateStr=u.date.toLocaleString(),e.next=21,nn.auth.getUserCached(u.userId);case 21:u._user=e.sent,d="",u.typesId.forEach(((e,t)=>{0!==t&&(d+=" | ");const r=a.find((t=>t._id===e));d+=r.name})),u._tagTypesStr=d;case 25:e.next=15;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(13),o.e(e.t0);case 32:return e.prev=32,o.f(),e.finish(32);case 35:return e.abrupt("return",c);case 38:throw e.prev=38,e.t1=e.catch(0),e.t1;case 41:case"end":return e.stop()}}),e,null,[[0,38],[13,29,32,35]])})));return function(t,a){return e.apply(this,arguments)}}(),Jn=(e,t)=>{switch(e.opField){case"dis":return"".concat(Math.round(t/100)/10," km");case"total_elevation_gain":return"".concat(t," m");case"moving_time":return(e=>{let t=Math.floor(e/3600),a=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return a<10&&(a="0"+a),r<10&&(r="0"+r),"".concat(t,":").concat(a,":").concat(r)})(t);default:return t.toString()}},Kn=(e,t)=>(e=>{const t=e.substring(0,4),a=e.substring(4,6),r=e.substring(6,8);return new Date(t,a,r)})(e.toString()).toLocaleString(t,{month:"long",year:"numeric"}),Hn=function(){var e=Object(fe.a)(he.a.mark((function e(t){var a;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.get("userClubs",[{field:"clubs",value:t}],{field:"_id",dir:"asc"},{limit:200,skip:0},["_id"]);case 3:return a=e.sent,e.abrupt("return",a.data.map((e=>e._id)));case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),Yn=function(){var e=Object(fe.a)(he.a.mark((function e(t,a,r,s,n){var i,c,o,l,u,d,p;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,i=Object(wn.a)(a),e.prev=2,i.s();case 4:if((c=i.n()).done){e.next=12;break}if(!((o=c.value).value instanceof Function)){e.next=10;break}return e.next=9,o.value();case 9:o.value=e.sent;case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),i.e(e.t0);case 17:return e.prev=17,i.f(),e.finish(17);case 20:return e.next=22,nn.store.aggregation("activities",t,a,s,r);case 22:l=e.sent,u=Object(wn.a)(l.data),e.prev=24,u.s();case 26:if((d=u.n()).done){e.next=38;break}if(p=d.value,"userId"!==t.field){e.next=34;break}return e.next=31,nn.auth.getUserCached(p._id);case 31:p._user=e.sent,e.next=35;break;case 34:"month"===t.field?p._id=Kn(p._id,n):"year"===t.field&&(p._id=p._id.toString().substring(0,4));case 35:p.val=Jn(t,p.val);case 36:e.next=26;break;case 38:e.next=43;break;case 40:e.prev=40,e.t1=e.catch(24),u.e(e.t1);case 43:return e.prev=43,u.f(),e.finish(43);case 46:return e.abrupt("return",l);case 49:throw e.prev=49,e.t2=e.catch(0),e.t2;case 52:case"end":return e.stop()}}),e,null,[[0,49],[2,14,17,20],[24,40,43,46]])})));return function(t,a,r,s,n){return e.apply(this,arguments)}}(),Gn=function(){var e=Object(fe.a)(he.a.mark((function e(){var t;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.get(Sn);case 3:return t=e.sent,e.abrupt("return",t);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),Zn=function(){var e=Object(fe.a)(he.a.mark((function e(t){var a;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.getById(yn,t);case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),Xn=function(){var e=Object(fe.a)(he.a.mark((function e(t){var a;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.getById(Sn,t);case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),$n=function(){var e=Object(fe.a)(he.a.mark((function e(t){var a,r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={field:"date",op:"sum",opField:"duration"},e.next=4,nn.store.aggregation(kn,a,t);case 4:return(r=e.sent).sum=0,r.data.forEach((e=>{e.duration=e.val,e.name=new Date(e._id).toLocaleDateString("en-US"),r.sum+=e.val})),e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),Qn=function(){var e=Object(fe.a)(he.a.mark((function e(t,a){var r,s;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={field:"projectId",op:"sum",opField:"duration"},e.next=4,nn.store.aggregation(kn,r,t);case 4:return(s=e.sent).data.forEach((e=>{const t=a.find((t=>t._id===e._id));e.name=t?t.name:"none"})),e.abrupt("return",s);case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,a){return e.apply(this,arguments)}}(),ei=function(){var e=Object(fe.a)(he.a.mark((function e(t){var a,r,s,n,i,c;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={field:"userId",op:"sum",opField:"duration"},e.next=4,nn.store.aggregation(kn,a,t);case 4:r=e.sent,s=Object(wn.a)(r.data),e.prev=6,s.s();case 8:if((n=s.n()).done){e.next=16;break}return i=n.value,e.next=12,nn.auth.getUserCached(i._id);case 12:c=e.sent,i.name=c?c.name:"";case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),s.e(e.t0);case 21:return e.prev=21,s.f(),e.finish(21);case 24:return e.abrupt("return",r);case 27:throw e.prev=27,e.t1=e.catch(0),e.t1;case 30:case"end":return e.stop()}}),e,null,[[0,27],[6,18,21,24]])})));return function(t){return e.apply(this,arguments)}}(),ti=function(){var e=Object(fe.a)(he.a.mark((function e(t,a,r){var s,n,i,c,o;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s={field:"date",dir:"desc"},e.next=4,nn.store.get(kn,a,s,r);case 4:n=e.sent,i=Object(wn.a)(n.data),e.prev=6,i.s();case 8:if((c=i.n()).done){e.next=25;break}if((o=c.value).date=o.date?new Date(o.date):null,o._project=t.find((e=>e._id===o.projectId)),!o.taskId){e.next=18;break}return e.next=15,vi(o.taskId);case 15:e.t0=e.sent,e.next=19;break;case 18:e.t0={name:null};case 19:return o._task=e.t0,e.next=22,nn.auth.getUserCached(o.userId);case 22:o._user=e.sent;case 23:e.next=8;break;case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(6),i.e(e.t1);case 30:return e.prev=30,i.f(),e.finish(30);case 33:return e.abrupt("return",n);case 36:throw e.prev=36,e.t2=e.catch(0),e.t2;case 39:case"end":return e.stop()}}),e,null,[[0,36],[6,27,30,33]])})));return function(t,a,r){return e.apply(this,arguments)}}(),ai=function(){var e=Object(fe.a)(he.a.mark((function e(t,a,r){var s,n,i,c,o;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s={field:"start",dir:"desc"},e.next=4,nn.store.get(Tn,a,s,r);case 4:n=e.sent,i=Object(wn.a)(n.data),e.prev=6,i.s();case 8:if((c=i.n()).done){e.next=18;break}return(o=c.value).start=o.start?new Date(o.start):null,o.end=o.end?new Date(o.end):null,e.next=14,nn.auth.getUserCached(o.userId);case 14:o._user=e.sent,o._eventType=t.find((e=>e._id===o.eventTypeId));case 16:e.next=8;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(6),i.e(e.t0);case 23:return e.prev=23,i.f(),e.finish(23);case 26:return e.abrupt("return",n);case 29:throw e.prev=29,e.t1=e.catch(0),e.t1;case 32:case"end":return e.stop()}}),e,null,[[0,29],[6,20,23,26]])})));return function(t,a,r){return e.apply(this,arguments)}}(),ri=function(){var e=Object(fe.a)(he.a.mark((function e(t,a,r,s){var n,i,c,o;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.get(In,a,r,s);case 3:n=e.sent,i=Object(wn.a)(n.data);try{for(i.s();!(c=i.n()).done;)(o=c.value)._enumType=t.find((e=>e._id===o.enumTypeId))}catch(l){i.e(l)}finally{i.f()}return e.abrupt("return",n);case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,a,r,s){return e.apply(this,arguments)}}(),si=function(){var e=Object(fe.a)(he.a.mark((function e(t){var a,r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=[{field:"enumTypeId",op:"in",value:t},{field:"disabled",op:"ne",value:!0}],e.next=4,nn.store.get(In,a);case 4:return r=e.sent,e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),ni=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.delById(kn,t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),ii=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.delById(Tn,t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),ci=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.delById(In,t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),oi=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.delById(yn,t);case 3:return e.next=5,nn.store.del(Cn,[{field:"projectId",value:t}]);case 5:return e.next=7,nn.store.del(kn,[{field:"projectId",value:t}]);case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),li=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.delById(Cn,t);case 3:return e.next=5,nn.store.del(kn,[{field:"taskId",value:t}]);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),ui=function(){var e=Object(fe.a)(he.a.mark((function e(t,a,r){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.userId=a._id,t.projectId=r,e.next=5,nn.store.post(Cn,t);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a,r){return e.apply(this,arguments)}}(),di=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.put(Cn,t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),pi=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.put(Sn,t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),hi=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.put(Dn,t,t._id);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),fi=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.delById(Sn,t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),bi=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.delById(Dn,t._id);case 3:if(!t.imgId){e.next=6;break}return e.next=6,Mn(t.imgId);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),xi=function(){var e=Object(fe.a)(he.a.mark((function e(t,a,r,s){var n,i,c,o;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.get(Cn,a,s,r);case 3:n=e.sent,i=Object(wn.a)(n.data),e.prev=5,i.s();case 7:if((c=i.n()).done){e.next=22;break}if(!(o=c.value).assignedToId){e.next=15;break}return e.next=12,nn.auth.getUserCached(o.assignedToId);case 12:e.t0=e.sent,e.next=16;break;case 15:e.t0={name:null};case 16:o._assignedTo=e.t0,o._state=t.find((e=>e._id===o.stateId))||{name:null},o._type=t.find((e=>e._id===o.typeId))||{name:null};case 20:e.next=7;break;case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(5),i.e(e.t1);case 27:return e.prev=27,i.f(),e.finish(27);case 30:return e.abrupt("return",n);case 33:throw e.prev=33,e.t2=e.catch(0),e.t2;case 36:case"end":return e.stop()}}),e,null,[[0,33],[5,24,27,30]])})));return function(t,a,r,s){return e.apply(this,arguments)}}(),mi=function(){var e=Object(fe.a)(he.a.mark((function e(t){var a;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn.store.getById(Cn,t);case 3:return a=e.sent,e.abrupt("return",a);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),ji={},vi=function(){var e=Object(fe.a)(he.a.mark((function e(t){return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,ji[t]){e.next=5;break}return e.next=4,mi(t);case 4:ji[t]=e.sent;case 5:return e.abrupt("return",ji[t]);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();let gi;class Oi extends n.a.Component{constructor(e){var t;super(e),t=this,this.getProjects=Object(fe.a)(he.a.mark((function e(){var a;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.setState((e=>({projects:Object(o.a)(Object(o.a)({},e.projects),{},{isLoading:!0})}))),e.next=4,Bn();case 4:(a=e.sent).isLoading=!1,t.setState({projects:a}),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),this.getTags=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r,s;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.setState((e=>({tags:Object(o.a)(Object(o.a)({},e.tags),{},{isLoading:!0})}))),e.next=4,si([2]);case 4:return r=e.sent,e.next=7,Vn(a,r.data);case 7:(s=e.sent).isLoading=!1,t.setState({tags:s,enums:r}),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(0),t.setState((e=>({tags:Object(o.a)(Object(o.a)({},e.tags),{},{isLoading:!1})}))),e.t0;case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),this.getActivities=function(){var e=Object(fe.a)(he.a.mark((function e(a,r,s,n,i){var c;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.setState((e=>({activities:Object(o.a)(Object(o.a)({},e.activities),{},{isLoading:!0})}))),e.next=4,Yn(a,r,s,n,i);case 4:(c=e.sent).isLoading=!1,t.setState({activities:c}),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),t.setState((e=>({activities:Object(o.a)(Object(o.a)({},e.activities),{},{isLoading:!1})}))),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,a,r,s,n){return e.apply(this,arguments)}}(),this.handleChange=(e,t)=>{this.setState({[e]:t})},this.getProject=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r,s,n,i,c,o;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Zn(a);case 3:r=e.sent,s=[],n=Object(wn.a)(r.collaborators),e.prev=6,n.s();case 8:if((i=n.n()).done){e.next=16;break}return c=i.value,e.next=12,xn(c);case 12:o=e.sent,s.push(o);case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),n.e(e.t0);case 21:return e.prev=21,n.f(),e.finish(21);case 24:t.setState({project:r,users:{total:s.length,data:s}}),e.next=30;break;case 27:throw e.prev=27,e.t1=e.catch(0),e.t1;case 30:case"end":return e.stop()}}),e,null,[[0,27],[6,18,21,24]])})));return function(t){return e.apply(this,arguments)}}(),this.getClient=function(){var e=Object(fe.a)(he.a.mark((function e(a){var r;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xn(a);case 3:r=e.sent,t.setState({client:r}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),this.getClients=Object(fe.a)(he.a.mark((function e(){var a;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.setState((e=>({clients:Object(o.a)(Object(o.a)({},e.clients),{},{isLoading:!0})}))),e.next=4,Gn();case 4:(a=e.sent).isLoading=!1,t.setState({clients:a}),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),this.refreshTimeRecords=Object(fe.a)(he.a.mark((function e(){var a,r,s,n,i,c,l,u;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.setState((e=>({timeRecords:Object(o.a)(Object(o.a)({},e.timeRecords),{},{isLoading:!0})}))),a=t.state.timeRecords,r=a.filters,s=a.page,e.next=5,Bn();case 5:return n=e.sent,e.next=8,ti(n.data,r,s);case 8:return i=e.sent,e.next=11,$n(r);case 11:return c=e.sent,e.next=14,Qn(r,n.data);case 14:return l=e.sent,e.next=17,ei(r);case 17:u=e.sent,i.isLoading=!1,t.setState({timeRecords:i,dateStats:c,projectStats:l,userStats:u,projects:n}),e.next=25;break;case 22:throw e.prev=22,e.t0=e.catch(0),e.t0;case 25:case"end":return e.stop()}}),e,null,[[0,22]])}))),this.refreshEvents=Object(fe.a)(he.a.mark((function e(){var a,r,s,n;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.setState((e=>({events:Object(o.a)(Object(o.a)({},e.events),{},{isLoading:!0})}))),a=t.state.events,r=a.filters,s=a.page,e.next=5,ai(t.state.enums.data,r,s);case 5:(n=e.sent).isLoading=!1,t.setState({events:n}),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),this.getEvents=function(){var e=Object(fe.a)(he.a.mark((function e(a,r){var s,n,i;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.setState((e=>({events:Object(o.a)(Object(o.a)({},e.events),{},{isLoading:!0})}))),e.next=4,bn([]);case 4:return s=e.sent,e.next=7,si([1]);case 7:return n=e.sent,e.next=10,ai(n.data,a,r);case 10:return(i=e.sent).isLoading=!1,t.setState({events:i,users:s,enums:n}),e.abrupt("return",i);case 16:throw e.prev=16,e.t0=e.catch(0),e.t0;case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,a){return e.apply(this,arguments)}}(),this.getEnums=function(){var e=Object(fe.a)(he.a.mark((function e(a,r,s,n=!0){var i;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n){e.next=5;break}return e.next=4,ri(t.state.enumTypes.data,a,r,s);case 4:return e.abrupt("return",e.sent);case 5:return t.setState((e=>({enums:Object(o.a)(Object(o.a)({},e.events),{},{isLoading:!0})}))),e.next=8,ri(t.state.enumTypes.data,a,r,s);case 8:return(i=e.sent).isLoading=!1,t.setState({enums:i}),e.abrupt("return",i);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,a,r){return e.apply(this,arguments)}}(),this.refreshEnums=Object(fe.a)(he.a.mark((function e(){var a,r,s,n,i;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.setState((e=>({enums:Object(o.a)(Object(o.a)({},e.enums),{},{isLoading:!0})}))),a=t.state.enums,r=a.filters,s=a.sort,n=a.page,e.next=5,ri(t.state.enumTypes.data,r,s,n);case 5:(i=e.sent).isLoading=!1,t.setState({enums:i}),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),this.refreshTasks=Object(fe.a)(he.a.mark((function e(){var a,r,s,n,i;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.setState((e=>({tasks:Object(o.a)(Object(o.a)({},e.tasks),{},{isLoading:!0})}))),a=t.state.tasks,r=a.filters,s=a.page,n=a.sort,e.next=5,xi(t.state.enums.data,r,s,n);case 5:(i=e.sent).isLoading=!1,t.setState({tasks:i}),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),this.getTasks=function(){var e=Object(fe.a)(he.a.mark((function e(a,r,s,n,i=!0){var c,l,u;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=[...r,{field:"projectId",op:"eq",value:a}],e.prev=1,i){e.next=9;break}return e.next=5,si([3,4]);case 5:return l=e.sent,e.next=8,xi(l.data,c,s,n);case 8:return e.abrupt("return",e.sent);case 9:return t.setState((e=>({tasks:Object(o.a)(Object(o.a)({},e.tasks),{},{isLoading:!0})}))),e.next=12,si([3,4]);case 12:return l=e.sent,e.next=15,xi(l.data,c,s,n);case 15:return(u=e.sent).isLoading=!1,t.setState({tasks:u,enums:l}),e.abrupt("return",u);case 21:throw e.prev=21,e.t0=e.catch(1),e.t0;case 24:case"end":return e.stop()}}),e,null,[[1,21]])})));return function(t,a,r,s){return e.apply(this,arguments)}}(),this.getOpenedTasks=function(){var e=Object(fe.a)(he.a.mark((function e(a,r){var s;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=[{field:"stateId",op:"ne",value:3},{field:"assignedToId",op:"in",value:[r._id,""]}],e.next=4,t.getTasks(a,s,void 0);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}(),this.likeTag=(e,t)=>{this.setState((a=>({tags:Object(o.a)(Object(o.a)({},a.tags),{},{data:a.tags.data.map((a=>{if(a._id===e){const e=a.likes.indexOf(t._id);e>-1?(a.likes.splice(e,1),a.likesCnt=a.likesCnt-1):(a.likes.push(t._id),a.likesCnt=a.likesCnt+1),hi(a)}return a}))})})))},this.getTimeRecords=function(){var e=Object(fe.a)(he.a.mark((function e(a,r,s=!0){var n,i,c,l,u,d,p;return he.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s){e.next=9;break}return e.next=4,Bn();case 4:return n=e.sent,i=[...a,{field:"projectId",op:"in",value:n.data.map((e=>e._id))}],e.next=8,ti(n.data,i,r);case 8:return e.abrupt("return",e.sent);case 9:return t.setState((e=>({timeRecords:Object(o.a)(Object(o.a)({},e.timeRecords),{},{isLoading:!0})}))),e.next=12,Bn();case 12:return n=e.sent,e.next=15,bn([]);case 15:return c=e.sent,i=[...a,{field:"projectId",op:"in",value:n.data.map((e=>e._id))}],e.next=19,ti(n.data,i,r);case 19:return l=e.sent,e.next=22,$n(i);case 22:return u=e.sent,e.next=25,Qn(i,n.data);case 25:return d=e.sent,e.next=28,ei(a);case 28:return p=e.sent,l.isLoading=!1,t.setState({timeRecords:l,dateStats:u,projectStats:d,userStats:p,projects:n,users:c}),e.abrupt("return",l);case 34:throw e.prev=34,e.t0=e.catch(0),e.t0;case 37:case"end":return e.stop()}}),e,null,[[0,34]])})));return function(t,a){return e.apply(this,arguments)}}(),this.handleChangeCollection=e=>{console.log("CHANGED: "+e)},this.state={timeRecords:{total:0,data:[],filters:[],page:null,isLoading:!1},events:{total:0,data:[],filters:[],page:null,isLoading:!1},enums:{total:0,data:[],filters:[],page:null,isLoading:!1},projects:{total:0,data:[],filters:[],isLoading:!1},project:null,client:null,dateStats:{data:[],sum:0},projectStats:{data:[]},userStats:{data:[]},users:{total:0,data:[]},tasks:{total:0,data:[],isLoading:!1},clients:{total:0,data:[],isLoading:!1},enumTypes:{total:2,data:[{_id:1,name:"event"},{_id:2,name:"tag"},{_id:3,name:"state"},{_id:4,name:"task"}]},projectId:null,tags:{total:0,data:[],filters:[],isLoading:!1},activities:{total:0,data:[],isLoading:!1}}}render(){const e=this.props.children;return!gi&&nn.storage.getUser()&&(gi=!0),Object(r.jsx)(Re.Provider,{value:Object(o.a)({addTimeRecord:_n,addEvent:En,getTimeRecords:this.getTimeRecords,getEvents:this.getEvents,refreshEvents:this.refreshEvents,refreshTimeRecords:this.refreshTimeRecords,deleteTimeRecord:ni,deleteEvent:ii,addProject:Pn,addClient:Fn,addTag:An,getClients:this.getClients,editClient:pi,editTag:hi,deleteClient:fi,getProjects:this.getProjects,deleteProject:oi,deleteTag:bi,addTask:ui,editTask:di,deleteTask:li,refreshTasks:this.refreshTasks,editProject:Un,editTimeRecord:Wn,editEvent:qn,getTasks:this.getTasks,getProject:this.getProject,getClient:this.getClient,getOpenedTasks:this.getOpenedTasks,handleChange:this.handleChange,getTags:this.getTags,likeTag:this.likeTag,getActivities:this.getActivities,getFile:Rn,getUsersInClub:Hn,getEnums:this.getEnums,refreshEnums:this.refreshEnums,addEnum:Nn,editEnum:zn,deleteEnum:ci},this.state),children:e})}}var wi=Oi,ki=a(344),yi=a(345),Ci=a(346);Object(nn.init)(pa);const Si=Object(X.createMuiTheme)({palette:pa.palette});class Ti extends n.a.Component{componentDidMount(){document.documentElement.style.setProperty("--primary-color",pa.palette.primary.main),document.title="".concat("krdeldatlov"," v").concat("0.4.0")}render(){return Object(r.jsx)(On,{children:Object(r.jsx)(wi,{children:Object(r.jsx)(re,{locale:pa.locale,"en-US":yi,"sk-SK":Ci,children:Object(r.jsx)(X.MuiThemeProvider,{theme:Si,children:Object(r.jsx)(be.c,{utils:ki.a,children:Object(r.jsx)(sn,{})})})})})})}}c.a.render(Object(r.jsx)(Ti,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()}))}},[[745,1,2]]]);
//# sourceMappingURL=main.6251c658.chunk.js.map